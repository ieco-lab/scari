---
title: "deprecated_code"
author: "Sam Owens"
date: "2023-07-13"
output: html_document
---

This file was written to hold deprecated code chunks. The original file will be listed for each code chunk.

# vignette 050

## Attempt blocked cross validation 

I will split the presences into training and testing, using 60% of the points for training, 20% for tuning, and 20% for testing. 

```{r convert slf presences to sf object}

#presences
global_presences_with_data <- read_csv(
  file.path(here(), "vignette-outputs", "data-tables", "global_slf_presences_with_data_v3.csv")
  ) %>%
  # add presence/absence column
  mutate(pa = 1)

# background points
global_background_with_data <-  read_csv(
  file.path(here(), "vignette-outputs", "data-tables", "global_background_points_with_data_v3.csv")
  ) %>%
  mutate(pa = 0)


# join
global_all_points_with_data <- full_join(global_presences_with_data, global_background_with_data) %>%
  sf::st_as_sf(coords = c("X", "Y"), crs = 4326)

```

First, check spatial autocorrelation level

```{r check spatial autocorrelation level}

# set seed for consistency of random sampling
set.seed(2)

# take spatial autocorrelation distance
spatial_autocor <- blockCV::cv_spatial_autocor(
  x = global_all_points_with_data,
  column = "pa",
  plot = TRUE,
  progress = TRUE
)

spatial_autocor$range
spatial_autocor$plots

# OLD METHOD
# convert to a Lambert projection because variograms do not work with lat/long projections
# using EPSG:9834, Lambert Cylindrical Equal Area (Spherical)
#global_raster <- terra::project(x = x_global_hist_env_covariates, y = "EPSG:9834", method = "bilinear", threads = TRUE)
# test for spatial autocorrelation distance
#spatial_autocor <- blockCV::cv_spatial_autocor(
#  r = global_raster,
#  num_sample = 20000, # quadrupled from default due to raster size
#  plot = TRUE,
#  progress = TRUE
#)

```

The range of spatial autocorrelation is estimated at 1,495,777 meters for the presence/absence data I am using to build the model. 

```{r visualize block sizes}

blockCV::cv_block_size(
  x = global_all_points_with_data,
  column = "pa"
)

```


```{r}

global_folds <- blockCV::cv_spatial(
  x = global_all_points_with_data,
  column = "pa",
  r = x_global_hist_env_covariates,
  k = 5,
  size = 1495772,
  hexagon = FALSE, # I am pretty sure the function used to calculate the autocorrelation distance used square blocks
  selection = "random",
  iteration = 50,
  seed = 3,
  progress = TRUE, 
  report = TRUE
)



```

```{r output and plot}

# 
View(global_folds$folds_list)
# this fold list contains each block 
global_folds$records

blockCV::cv_plot(
  cv = global_folds,
  r = x_global_hist_env_covariates
)

```

```{r check similarity}

cv_similarity

```

```{r}

global_folds <- blockCV::cv_cluster(
  x = global_all_points_with_data,
  column = "pa",
  k = 10,
  r = x_global_hist_env_covariates,
  scale = TRUE,
  raster_cluster = TRUE,
  report = TRUE
)

```


```{r set random seed}

# set random seed so it is consistent every time
set.seed(4)

```

## Slf Points kfold

For the slf presences, I will divide them into training and testing folds using `dismo::kfold()`. I will be running these models with 5 replicates, so I will divide the presence data into 5 groups (80% training, 20% testing). The 20% group that is used for testing is cycled per model replicate. This is in preparation for MaxEnt to perform k-fold cross validation. 

```{r}
# convert to raster stack
 x_env_covariates <- raster::stack(x = x_env_covariates_list)

 nlayers(x_env_covariates)
 names(x_env_covariates)
# cellStats(x_env_covariates, stat = "min")
# cellStats(x_env_covariates, stat = "max")
```


```{r endings used to load in files}

 mutate(row.number = seq(nrow(.))) %>%
  dplyr::select(row.number, x, y) 

  dplyr::select(row.number, x, y) 

```


```{r divide presences into kfold groups}

# get kfold of groups
p_slf_points_kfold <- kfold(p_slf_points, k = 5) %>%
  as.data.frame() %>%
  mutate(row.number = seq(nrow(p_slf_points)))
# change names of variables
names(p_slf_points_kfold) <- c("kfold_group", "row.number")


p_slf_points_kfold <- full_join(p_slf_points, p_slf_points_kfold, by = "row.number") %>%
  dplyr::select(kfold_group, x, y)

```

```{r plot}

(ggplot() +
   geom_polygon(data = map_data('world'), aes(x = long, y = lat, group = group), fill = "white", color = "black", lwd = 0.15) +
   geom_point(data = p_slf_points_kfold, aes(x = x, y = y, color = as.factor(kfold_group)), size = 1) +
   map_style +
   guides(color = guide_legend(override.aes = list(size = 2))) +
   coord_equal(xlim = c(-87.747803, -66.840820), ylim = c(34.678394, 42.956423))
)

```

## Background Points kfold

Now, I will perform the same procedure for each of the 3 sets of background points.

```{r divide entire easternUSA absence dataset into kfold groups}

# get kfold of groups
a_entire_easternUSA_background_points_kfold <- kfold(a_entire_easternUSA_background_points, k = 5) %>%
  as.data.frame() %>%
  mutate(row.number = seq(nrow(a_entire_easternUSA_background_points)))
# change names of variables
names(a_entire_easternUSA_background_points_kfold) <- c("kfold_group", "row.number")


a_entire_easternUSA_background_points_kfold <- full_join(a_entire_easternUSA_background_points, a_entire_easternUSA_background_points_kfold, by = "row.number") %>%
  dplyr::select(kfold_group, x, y)

```

```{r divide DD absence dataset into kfold groups}

# get kfold of groups
a_adult_emergence_1_background_points_kfold <- kfold(a_adult_emergence_1_background_points, k = 5) %>%
  as.data.frame() %>%
  mutate(row.number = seq(nrow(a_adult_emergence_1_background_points)))
# change names of variables
names(a_adult_emergence_1_background_points_kfold) <- c("kfold_group", "row.number")


a_adult_emergence_1_background_points_kfold <- full_join(a_adult_emergence_1_background_points, a_adult_emergence_1_background_points_kfold, by = "row.number") %>%
  dplyr::select(kfold_group, x, y)

```

```{r divide 355km buffer absence dataset into kfold groups}

# get kfold of groups
a_slf_buffered_background_points_kfold <- kfold(a_slf_buffered_background_points, k = 5) %>%
  as.data.frame() %>%
  mutate(row.number = seq(nrow(a_slf_buffered_background_points)))
# change names of variables
names(a_slf_buffered_background_points_kfold) <- c("kfold_group", "row.number")


a_slf_buffered_background_points_kfold <- full_join(a_slf_buffered_background_points, a_slf_buffered_background_points_kfold, by = "row.number") %>%
  dplyr::select(kfold_group, x, y)

```

## Maxent Using dismo pkg

Use `if(dismo::maxent()) { }` to test whether maxent will run on data given to it before actually running the models.

*Note* I prefer to do spatial data manipulation in `terra`, but `dismo` is only compatible with the `raster` package.

```{r object of maxent settings}

maxent_settings <- c(
  "linear=true", # all feature types allowed
  "quadratic=true", 
  "product=true",
  "threshold=true",
  "hinge=true",
  "responsecurves=true", # create response curves
  "jackknife=true", # do jackknife analysis
  "replicates=5", # do 5 replicates for run (k-fold)
  "replicatetype=crossvalidate", # k-fold cross validation
  "randomtestpoints=20", # randomly set aside 20% of presences for testing
  "maximumiterations=5000", # max number of iterations of optimization algorithm to perform before stopping training
  "threads=6", # number of physical cores in my desktop
  "nodata=-9999",# no data value
  "writeplotdata=true" 
) 

```

```{r}
test1 <- dismo::prepareData(x = x_env_covariates, 
            p = p_slf_points, 
            b = a_entire_easternUSA_background_points,
            xy = TRUE)
```

```{r create directory}

mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models")

# create file directory
dir.create(path = file.path(mypath, "maxent_R_trial", "results"))

```

```{r trial of maxent (entire eastern USA)}

if(dismo::maxent()) {
  
   test_model <- maxent(
     x = x_env_covariates, # raster stack
     p = p_slf_points, # presences
     a = a_entire_easternUSA_background_points,
     path = file.path(mypath, "maxent_R_trial"), 
     removeDuplicates = TRUE,
     args = maxent_settings
   )
}

```

```{r prediction settings}

prediction_settings <- c(
  "linear=true", # all feature types allowed
  "quadratic=true", 
)

```


```{r explore model results}

# bring up .html file
test_model
# test statistics
test_model@results

# make predictions to eastern USA
test_model_easternUSA <- dismo::predict(object = test_model, 
                                        x = x_env_covariates,
                                        filename = file.path(mypath, "maxent_R_trial", "results"),
                                        progress = "text")

#
dismo::predict(object = test_model, 
               x = x_env_covariates,
               filename = file.path(mypath, "maxent_R_trial", "results"),
               progress = "text")

```


```{r}

weight <- sort(rnorm(n = 100, mean = 172, sd = 29))

obese <- ifelse(test = runif(n = 100) < rank(weight)/100)

```


```{r predict function to create raster}

# output directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_buffered_step1")

# write .asc file of avg predictions
SDMtune::predict(
  object = easternUSA_buffered_model, 
  data = x_env_covariates, # the covariate layers used to train the model
  fun = "mean", 
  type = "cloglog", 
  clamp = FALSE, 
  progress = TRUE, 
  filename = file.path(mypath, "easternUSA_buffered_predicted_suitability.asc"), 
    # the function automatically adds the function name on the end
  filetype = "AAIGrid"
) 

```

```{r convert to df and plot}

# load in mean predictions
easternUSA_buffered_suit <- terra::rast(x = file.path(mypath, "easternUSA_buffered_predicted_suitability_mean.asc")) %>%
  terra::as.data.frame(., xy = TRUE) 
  
# plot
easternUSA_buffered_suit_plot <- ggplot() +
  geom_raster(data = easternUSA_buffered_suit, 
              aes(x = x, y = y, fill = mean)) +
  labs(title = "Mean suitability for SLF",
       subtitle = "Model: easternUSA_buffered") +
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_buffered_suit_plot, 
           filename = file.path(mypath, "plots", "easternUSA_buffered_predicted_suitability_mean.jpg"),
           height = 8, 
           width = 10,
           device = "jpeg",
           dpi = "retina")

```

### Reclassify mean suitability map

```{r discern MTSS threshold}

# output directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_buffered_step1")

MTSS_value <- read.csv(file = file.path(mypath, "easternUSA_buffered_summary_all_iterations.csv")) %>%
  .[42, 6]

```

#### Create binary raster with MTSS threshold

```{r terra required classification matrices}

# create regional suitability value matrix for terra
buffered_rescale_class <- data.frame(
  from = c(0, MTSS_value),
  to = c(MTSS_value, 1),
  becomes = c(0, 1)
)

```

```{r reclassify maxent outputs}

# path to directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_buffered_step1")

# load in raster
buffered_mean_raster <- terra::rast(x = file.path(mypath, "easternUSA_buffered_predicted_suitability_mean.asc"))

if(FALSE) {
  
  terra::classify(x = buffered_mean_raster, 
                  rcl = buffered_rescale_class,
                  right = FALSE, # close left side of value
                  filename = file.path(mypath, "easternUSA_buffered_predicted_suitability_mean_thresholded.asc"), # also write to file
                  overwrite = FALSE
                  ) 
  
}
  
```

#### Create mask raster and overlay on mean

```{r reclassify maxent outputs}

# create regional suitability value matrix for terra
buffered_rescale_class <- data.frame(
  from = 0,
  to = MTSS_value,
  becomes = 1
)

if(TRUE) {
  
  # reclassify and write regional raster
  buffered_mask_layer <- terra::classify(x = buffered_mean_raster, 
                                             rcl = buffered_rescale_class,
                                             right = FALSE, # close left side of value
                                             others = NA,
                                             filename = file.path(mypath, "easternUSA_buffered_MTSS_mask_layer.asc"), # also write to file
                                             overwrite = FALSE) 
  
}
  
```

```{r overlay plots}
  
# load in mean predictions
buffered_mask_layer_df <- terra::rast(x = file.path(mypath, "easternUSA_buffered_MTSS_mask_layer.asc")) %>%
  terra::as.data.frame(., xy = TRUE)

# plot mean raster first
easternUSA_buffered_threshold_plot <- ggplot() +
  # plot regular raster of values first
  geom_raster(data = easternUSA_buffered_suit, 
              aes(x = x, y = y, fill = mean)) +
    # plot binary threshold on top
  geom_raster(data = buffered_mask_layer_df, 
              aes(x = x, y = y), fill = "azure4")
  labs(title = "Suitability for SLF, MTSS training threshold",
       subtitle = "Model: 355km buffer") +
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_buffered_threshold_plot, 
           filename = file.path(mypath, "plots", "easternUSA_buffered_predicted_suitability_mean_thresholded.jpg"),
           height = 8, 
           width = 10,
           device = "jpeg",
           dpi = "retina")

```







```{r predict function to create raster}

# output directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_entire_step1_v1")

# write .asc file of avg predictions
SDMtune::predict(
  object = easternUSA_entire_model, 
  data = x_env_covariates, # the covariate layers used to train the model
  fun = "mean", 
  type = "cloglog", 
  clamp = FALSE, 
  progress = TRUE, 
  filename = file.path(mypath, "easternUSA_entire_predicted_suitability.asc"), 
    # the function automatically adds the function name on the end
  filetype = "AAIGrid"
) 

```

I will convert the raster to a data frame and use this to plot it and save a jpg.

```{r convert to df and plot}

# load in mean predictions
easternUSA_entire_suit <- terra::rast(x = file.path(mypath, "easternUSA_entire_predicted_suitability_mean.asc")) %>%
  # terra::subst(., from = -9999, to = NA) %>% # change -9999 to NA for plotting
  terra::as.data.frame(., xy = TRUE) 
  
# plot
easternUSA_entire_suit_plot <- ggplot() +
  geom_raster(data = easternUSA_entire_suit, 
              aes(x = x, y = y, fill = mean)) +
  labs(title = "Suitability for SLF") +
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_entire_suit_plot, 
           filename = file.path(mypath, "plots", "easternUSA_entire_predicted_suitability_mean.jpg"),
           height = 8, 
           width = 10,
           device = "jpeg",
           dpi = "retina")

```



```{r discern MTSS threshold}

# output directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_entire_step1_v1")

MTSS_value <- read.csv(file = file.path(mypath, "easternUSA_entire_summary_all_iterations.csv")) %>%
  .[42, 6]

```

#### Create binary raster with MTSS threshold

```{r terra required classification matrices}

# create regional suitability value matrix for terra
entire_rescale_class <- data.frame(
  from = c(0, MTSS_value),
  to = c(MTSS_value, 1),
  becomes = c(0, 1)
)

```

```{r reclassify maxent outputs}

# path to directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_entire_step1_v1")

# load in raster
entire_mean_raster <- terra::rast(x = file.path(mypath, "easternUSA_entire_predicted_suitability_mean.asc"))

if(FALSE) {
  
  terra::classify(x = entire_mean_raster, 
                  rcl = entire_rescale_class,
                  right = FALSE, # close left side of value
                  filename = file.path(mypath, "easternUSA_entire_predicted_suitability_mean_thresholded.asc"), # also write to file
                  overwrite = FALSE
                  ) 
  
}
  
```


```{r reclassify maxent outputs}

# create regional suitability value matrix for terra
entire_rescale_class <- data.frame(
  from = 0,
  to = MTSS_value,
  becomes = 1
)

# load in raster
entire_mean_raster <- terra::rast(x = file.path(mypath, "easternUSA_entire_predicted_suitability_mean.asc"))

if(FALSE) {
  
  # reclassify and write regional raster
  entire_mean_reclassify <- terra::classify(x = entire_mean_raster, 
                                  rcl = entire_rescale_class,
                                  right = FALSE, # close left side of value
                                  others = NA,
                                  filename = file.path(mypath, "easternUSA_entire_MTSS_mask_layer.asc"), # also write to file
                                  overwrite = FALSE) 
  
}
  
```

Now, I will overlay the plots

```{r overlay plots}
  
# load in mean predictions
entire_mean_reclassify_df <- terra::rast(x = file.path(mypath, "easternUSA_entire_MTSS_mask_layer.asc")) %>%
  terra::as.data.frame(., xy = TRUE)

# plot mean raster first
easternUSA_entire_threshold_plot <- ggplot() +
  # plot regular raster of values first
  geom_raster(data = easternUSA_entire_suit, 
              aes(x = x, y = y, fill = mean)) +
    # plot binary threshold on top
  geom_raster(data = entire_mean_reclassify_df, 
              aes(x = x, y = y), fill = "azure4")
  labs(title = "Suitability for SLF, MTSS training threshold",
       subtitle = "Model: easternUSA_entire") 
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_entire_threshold_plot, 
           filename = file.path(mypath, "plots", "easternUSA_entire_predicted_suitability_mean_thresholded.jpg"),
           height = 8, 
           width = 10,
           device = "jpeg",
           dpi = "retina")

```








```{r predict function to create raster}

# output directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_adult_emer_1_step1")

# write .asc file of avg predictions
SDMtune::predict(
  object = easternUSA_adult_emer_1_model, 
  data = x_env_covariates, # the covariate layers used to train the model
  fun = "mean", 
  type = "cloglog", 
  clamp = FALSE, 
  progress = TRUE, 
  filename = file.path(mypath, "easternUSA_adult_emer_1_predicted_suitability.asc"), 
    # the function automatically adds the function name on the end
  filetype = "AAIGrid"
) 

```

```{r convert to df and plot}

# load in mean predictions
easternUSA_adult_emer_1_suit <- terra::rast(x = file.path(mypath, "easternUSA_adult_emer_1_predicted_suitability_mean.asc")) %>%
  terra::as.data.frame(., xy = TRUE) 
  
# plot
easternUSA_adult_emer_1_suit_plot <- ggplot() +
  geom_raster(data = easternUSA_adult_emer_1_suit, 
              aes(x = x, y = y, fill = mean)) +
  labs(title = "Mean suitability for SLF",
       subtitle = "Model: easternUSA_adult_emer_1") +
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_adult_emer_1_suit_plot, 
           filename = file.path(mypath, "plots", "easternUSA_adult_emer_1_predicted_suitability_mean.jpg"),
           height = 8, 
           width = 10,
           device = "jpeg",
           dpi = "retina")

```

### Reclassify mean suitability map

```{r discern MTSS threshold}

# output directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_adult_emer_1_step1")

MTSS_value <- read.csv(file = file.path(mypath, "easternUSA_adult_emer_1_summary_all_iterations.csv")) %>%
  .[42, 6]

```

#### Create binary raster with MTSS threshold

```{r terra required classification matrices}

# create regional suitability value matrix for terra
adult_emer_1_rescale_class <- data.frame(
  from = c(0, MTSS_value),
  to = c(MTSS_value, 1),
  becomes = c(0, 1)
)

```

```{r reclassify maxent outputs}

# path to directory
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_adult_emer_1_step1")

# load in raster
adult_emer_1_mean_raster <- terra::rast(x = file.path(mypath, "easternUSA_adult_emer_1_predicted_suitability_mean.asc"))

if(FALSE) {
  
  terra::classify(x = adult_emer_1_mean_raster, 
                  rcl = adult_emer_1_rescale_class,
                  right = FALSE, # close left side of value
                  filename = file.path(mypath, "easternUSA_adult_emer_1_predicted_suitability_mean_thresholded.asc"), # also write to file
                  overwrite = FALSE
                  ) 
  
}
  
```

#### Create mask raster and overlay on mean

```{r reclassify maxent outputs}

# create regional suitability value matrix for terra
adult_emer_1_rescale_class <- data.frame(
  from = 0,
  to = MTSS_value,
  becomes = 1
)

if(FALSE) {
  
  # reclassify and write regional raster
  adult_emer_1_mask_layer <- terra::classify(x = adult_emer_1_mean_raster, 
                                  rcl = adult_emer_1_rescale_class,
                                  right = FALSE, # close left side of value
                                  others = NA,
                                  filename = file.path(mypath, "easternUSA_adult_emer_1_MTSS_mask_layer.asc"), # also write to file
                                  overwrite = FALSE) 
  
}
  
```

```{r overlay plots}
  
# load in mean predictions
adult_emer_1_mask_layer_df <- terra::rast(x = file.path(mypath, "easternUSA_adult_emer_1_MTSS_mask_layer.asc")) %>%
  terra::as.data.frame(., xy = TRUE)

# plot mean raster first
easternUSA_adult_emer_1_threshold_plot <- ggplot() +
  # plot regular raster of values first
  geom_raster(data = easternUSA_adult_emer_1_suit, 
              aes(x = x, y = y, fill = mean)) +
  # plot binary threshold on top
  geom_raster(data = adult_emer_1_mask_layer_df, 
              aes(x = x, y = y), fill = "azure4")
  labs(title = "Suitability for SLF, MTSS training threshold",
       subtitle = "Model: DD 1% adult emergence") +
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_adult_emer_1_threshold_plot, 
           filename = file.path(mypath, "plots", "easternUSA_adult_emer_1_predicted_suitability_mean_thresholded.jpg"),
           height = 8, 
           width = 10,
           device = "jpeg",
           dpi = "retina")

```

Finally, I will also 

The next three models will follow roughly the same structure, so comments will be kept to a minimum because the workflow will be the same

TEST PREDICTION USING ENTIRE EASTERN USA for N AMERICA- will likely be moved to vignette 070 for model creation and analysis.

```{r project to N America using entire eastern USA model}

# input path
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/historical_climate_rasters/chelsa2.1_30arcsec")

# list of rasters to load in
NAmerica_rasters_list <- list.files(path = file.path(mypath, "v1_maxent"), pattern = "\\.asc$", full.names = TRUE) %>%
  grep("bio2_1981-2010_NAmerica.asc|bio11_1981-2010_NAmerica.asc|bio12_1981-2010_NAmerica.asc|bio15_1981-2010_NAmerica.asc", ., value = TRUE)

# load in rasters to project to
NAmerica_rasters <- terra::rast(x = NAmerica_rasters_list)
# change layer names
names(NAmerica_rasters) <- env_layer_names

# new output path
mypath <- file.path(here() %>% 
                       dirname(),
                     "maxent/models/slf_easternUSA_entire_step1_v1")


# load model object
readr::read_rds(file = file.path(mypath, "easternUSA_entire_model.rds"))


easternUSA_entire_NAmerica_predict <- SDMtune::predict(
  object = easternUSA_entire_model,
  data = NAmerica_rasters,
  fun = "mean",
  type = "cloglog",
  clamp = FALSE, 
  progress = TRUE, 
  filename = file.path(mypath, "easternUSA_entire_predicted_suitability_NAmerica.asc"), 
    # the function automatically adds the function name on the end
  filetype = "AAIGrid"
)

# convert to df
easternUSA_entire_NAmerica_predict_df <- terra::as.data.frame(easternUSA_entire_NAmerica_predict, xy = TRUE)

# plot data
easternUSA_entire_NAmerica_predict_plot <- ggplot() +
  geom_raster(data = easternUSA_entire_NAmerica_predict_df,
              aes(x = x, y = y, fill = mean)) +
  labs(title = "MEAN suitability for SLF",
       subtitle = paste0("Model: easternUSA_entire, projected to N America")) +
  viridis::scale_fill_viridis(option = "D") +
  map_style

# save plot output
ggsave(easternUSA_entire_NAmerica_predict_plot,
       filename = file.path(mypath, "plots", "easternUSA_entire_predicted_suitability_mean_NAmerica.jpg"),
       height = 8,
       width = 10,
       device = "jpeg",
       dpi = "retina")


```

