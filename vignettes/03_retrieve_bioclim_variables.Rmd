---
title: "Retrieve bioclim rasters from CHELSA and tidy them for MaxEnt modeling"
author: "Sam Owens"
date: "2023-07-17"
contact: 'sam.owens@temple.edu'
output: html_document
---

This vignette will walk through the process of downloading and tidying CHELSA climate rasters. [CHELSA](https://chelsa-climate.org/) represents a high-resolution (30 arc-seconds, ~1km) land surface dataset provided by the Swiss Federal Institute for Forest, Snow and Landscape Research. The specific data we are interested in is the suite of 19 "bioclimatic" variables. These [bioclim variables](https://chelsa-climate.org/wp-admin/download-page/CHELSA_tech_specification_V2.pdf) are biologically relevant climate features derived from temperature and precipitation. CHELSA also makes the same variables available as climate change predictions, using a subset of the available [CMIP6](https://pcmdi.llnl.gov/CMIP6/) models. 

First, I will download the data from CHELSA into a local library using the `rchelsa` package.

Next, I will tidy the data for MaxEnt. 

Lastly, I will visualize the rasters.

# Setup

```{r load necesssary packages, echo = FALSE}

library(tidyverse)  #data manipulation

library(here) #making directory pathways easier on different instances
here()
# here() is ".../Shared drives/slfClimate/projects/slfSpread/slfSpread_pkg"

library(devtools)




```

# 1. Retrieve CHELSA bioclim

First, I will download the bioclim data into a local directory. I recommend downloading these data into a separate directory from this package. Since I am using a directory outside of the immediate package, I will create an object to define the file path at the beginning of each chunk. This pathing will still use `here::here()` to start at the package root folder. First, I will download the historical climate data from CHELSA.

```{r download historical CHELSA data}

if(TRUE) {

  # file path to local directory
  mypath <- file.path(here() %>% 
                          dirname(),
                        "maxent/historical_climate_rasters/chelsa2.1_30arcsec")
  
  # loop to download historical URLs
  # will make a loop to download URLs
  
  
 
}

```

Next, I will download data from the provided CMIP6 models. I will be downloading data from two different [SSP scenarios](https://www.carbonbrief.org/explainer-how-shared-socioeconomic-pathways-explore-future-climate-change/), SSP1-26 and SSP5-85 (see link for an explanation of these scenarios). I will use the [GFDL-ESM4](https://www.wdc-climate.de/ui/cmip6?input=CMIP6.CMIP.NOAA-GFDL.GFDL-ESM4) model . According to the CHELSA documentation, if all models are not used together, then CMIP6 model usage should follow the given priority (see documentation linked above).

```{r download CMIP6 CHELSA data}



```


# 


# Citations

Karger, D.N., Conrad, O., Böhner, J., Kawohl, T., Kreft, H., Soria-Auza, R.W., Zimmermann, N.E., Linder, P., Kessler, M. (2017). Climatologies at high resolution for the Earth land surface areas. Scientific Data. 4 170122. https://doi.org/10.1038/sdata.2017.122

Karger D.N., Conrad, O., Böhner, J., Kawohl, T., Kreft, H., Soria-Auza, R.W., Zimmermann, N.E,, Linder, H.P., Kessler, M.. Data from: Climatologies at high resolution for the earth’s land surface areas. Dryad Digital Repository.http://dx.doi.org/doi:10.5061/dryad.kd1d4
