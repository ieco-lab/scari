<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Run 'Rn' model trained on SLF native range in east Asia • scari</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run 'Rn' model trained on SLF native range in east Asia">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scari</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/scari.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quantify risk to specific viticultural regions</h6></li>
    <li><a class="dropdown-item" href="../articles/150_create_risk_report.html">Example usage of create_risk_report() to create reports of key viticultural areas</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Initialize scari</h6></li>
    <li><a class="dropdown-item" href="../articles/010_initialize_pkg.html">Initialization of renv package for dependencies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>1. Retrieve and tidy input data for MaxEnt</h6></li>
    <li><a class="dropdown-item" href="../articles/020_retrieve_bioclim_variables.html">Bioclim variable rasters: CHELSA</a></li>
    <li><a class="dropdown-item" href="../articles/030_retrieve_occurrence_records.html">SLF occurrence records: GBIF, lydemapR, literature</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>2. SDM modeling pipeline</h6></li>
    <li><a class="dropdown-item" href="../articles/040_setup_global_MaxEnt_model.html">Setup for global-scale MaxEnt model</a></li>
    <li><a class="dropdown-item" href="../articles/050_run_global_MaxEnt_model.html">Run global-scale MaxEnt model</a></li>
    <li><a class="dropdown-item" href="../articles/060_setup_regional_MaxEnt_models.html">Setup for regional-scale MaxEnt models</a></li>
    <li><a class="dropdown-item" href="../articles/070_run_regional_invaded_MaxEnt_model.html">Run 'Ri.NAmerica' model trained on SLF invaded region in North America</a></li>
    <li><a class="dropdown-item" href="../articles/080_run_regional_invaded_asian_MaxEnt_model.html">Run 'Ri.Asia' model trained on SLF invaded range in Japan and South Korea</a></li>
    <li><a class="dropdown-item" href="../articles/090_run_regional_native_MaxEnt_model.html">Run 'Rn' model trained on SLF native range in east Asia</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>3. Ensemble Regional-scale SDMs</h6></li>
    <li><a class="dropdown-item" href="../articles/100_run_ExDet_MIC.html">Run an Extrapolation Detection (NT2) analysis and calculate MIC</a></li>
    <li><a class="dropdown-item" href="../articles/110_ensemble_regional_models.html">Ensemble regional-scale models using a weighted mean</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>4. Quantify SLF risk and model fit</h6></li>
    <li><a class="dropdown-item" href="../articles/120_create_suitability_maps.html">Create risk maps of each model scale and intersect predictions</a></li>
    <li><a class="dropdown-item" href="../articles/130_create_suitability_xy_plots_viticultural.html">Plot shift in SLF risk to important viticultural regions under climate change</a></li>
    <li><a class="dropdown-item" href="../articles/131_create_suitability_xy_plots_SLF.html">Infer stability of known SLF populations due climate change effects</a></li>
    <li><a class="dropdown-item" href="../articles/140_plot_response_curves.html">Analyze biological realism of model response curves</a></li>
    <li><a class="dropdown-item" href="../articles/141_plot_AUC_var_cont.html">Check model goodness of fit via AUC, TSS and confusion matrices</a></li>
    <li><a class="dropdown-item" href="../articles/142_calculate_model_fit.html">Calculate model fit using confusion matrices</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ieco-lab/scari/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Run 'Rn' model trained on SLF native range in east Asia</h1>
                        <h4 data-toc-skip class="author">Samuel M.
Owens<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Temple University &lt;a href="http://www.biodiversitycenter.org/" class="external-link"&gt;Center for Biodiversity&lt;/a&gt; &lt;a href="https://www.iecolab.org/" class="external-link"&gt;iEco Lab&lt;/a&gt; &lt;a href="mailto:sam.owens@temple.edu" class="email"&gt;sam.owens@temple.edu&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">2024-08-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ieco-lab/scari/blob/HEAD/vignettes/090_run_regional_native_MaxEnt_model.Rmd" class="external-link"><code>vignettes/090_run_regional_native_MaxEnt_model.Rmd</code></a></small>
      <div class="d-none name"><code>090_run_regional_native_MaxEnt_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette trains the last regional-scale model, the Rn model,
which is based on the native range of SLF in east Asia. This vignette
follows the structure of the last two vignettes and trains the last
regional-scale model.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p><em>CURRENT MODEL VERSION: v3</em></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># general tools</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>  <span class="co">#data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span> <span class="co">#making directory pathways easier on different instances</span></span>
<span><span class="co"># here::here() starts at the root folder of this package.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SDMtune and dependencies</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://consbiol-unibern.github.io/SDMtune/" class="external-link">SDMtune</a></span><span class="op">)</span> <span class="co"># main package used to run SDMs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster/sdm/" class="external-link">dismo</a></span><span class="op">)</span> <span class="co"># package underneath SDMtune</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rforge.net/rJava/" class="external-link">rJava</a></span><span class="op">)</span> <span class="co"># for running MaxEnt</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sachsmc.github.io/plotROC/" class="external-link">plotROC</a></span><span class="op">)</span> <span class="co"># plots ROCs</span></span>
<span></span>
<span><span class="co"># spatial data handling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> I will be setting the global options of this
document so that only certain code chunks are rendered in the final
.html file. I will set the <code>eval = FALSE</code> so that none of the
code is re-run (preventing files from being overwritten during knitting)
and will simply overwrite this in chunks with plots.</p>
<p><code>SDMtune</code> will run MaxEnt through java via the
<code>rJava</code> package. You will need to ensure that your machine
has the proper version of java installed (x32 or x64) for your operating
system.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://consbiol-unibern.github.io/SDMtune/reference/checkMaxentInstallation.html" class="external-link">checkMaxentInstallation</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>This chunk sets the java memory allocation (<code>Xmx</code>). I will
increase the memory allocation from 512m (the default) to 2GB of
memory.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># xmx sets java memory allocation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>java.parameters <span class="op">=</span> <span class="st">"-Xmx2048m"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># xss sets java stack size</span></span>
<span><span class="co"># options(java.parameters = c("-Xss2560k", "-Xmx2048m"))</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="format-data-for-native-regional-model">1. Format Data for native regional Model<a class="anchor" aria-label="anchor" href="#format-data-for-native-regional-model"></a>
</h2>
<div class="section level3">
<h3 id="input-data--env-covariates">Input Data- env covariates<a class="anchor" aria-label="anchor" href="#input-data--env-covariates"></a>
</h3>
<p>I will load in the datasets I will need for the MaxEnt models. These
are labeled at the beginning of the object name by the parameter they
will be used for in the <code><a href="https://rdrr.io/pkg/dismo/man/maxent.html" class="external-link">maxent()</a></code> function (x, p or a). I
will begin by loading in the covariate data and then by loading in the
points datasets. The <code>env_covariates</code> dataset labeled
<code>native</code> contains a raster of each of the environmental
covariates used to train the model- these were the covariates that were
masked using the K-G climate zones in the last vignette.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># path to directory</span></span>
<span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/historical_climate_rasters/chelsa2.1_30arcsec"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># the env covariate scale used to train the model</span></span>
<span><span class="va">x_native_env_covariates_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"v1_maxent_10km"</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"\\_regional_native_KG.asc$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># dont include Access to cities</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"atc_2015"</span>, value <span class="op">=</span> <span class="cn">TRUE</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the scale used to make xy predictions</span></span>
<span><span class="va">x_global_hist_env_covariates_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"v1_maxent_10km"</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"\\.asc$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"bio2_1981-2010_global.asc|bio11_1981-2010_global.asc|bio12_1981-2010_global.asc|bio15_1981-2010_global.asc"</span>, <span class="va">.</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The CMIP6 versions of these covariates will only be used for
projection purposes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># path to directory</span></span>
<span>  <span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/future_climate_rasters/chelsa2.1_30arcsec"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the env covariates for performing xy predictions for global slf and IVR points</span></span>
<span></span>
<span><span class="co"># SSP126</span></span>
<span><span class="va">x_global_126_env_covariates_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"2041-2070_ssp126_GFDL"</span>, <span class="st">"v1_maxent_10km"</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"\\_global.asc$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># dont include Access to cities</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"atc_2015"</span>, value <span class="op">=</span> <span class="cn">TRUE</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SSP370</span></span>
<span><span class="va">x_global_370_env_covariates_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"2041-2070_ssp370_GFDL"</span>, <span class="st">"v1_maxent_10km"</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"\\_global.asc$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># dont include Access to cities</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"atc_2015"</span>, value <span class="op">=</span> <span class="cn">TRUE</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SSP585</span></span>
<span><span class="va">x_global_585_env_covariates_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"2041-2070_ssp585_GFDL"</span>, <span class="st">"v1_maxent_10km"</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"\\_global.asc$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># dont include Access to cities</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"atc_2015"</span>, value <span class="op">=</span> <span class="cn">TRUE</span>, invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>I will create rasters of the environmental covariates, stack and
gather summary statistics. I will also shorten their names and exclude
possible operators from layer names (for example, using the dash symbol
was found to interfere with SDMtune making predictions for tables
downstream).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># layer name object. Check order of layers first</span></span>
<span><span class="va">env_layer_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio11"</span>, <span class="st">"bio12"</span>, <span class="st">"bio15"</span>, <span class="st">"bio2"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># native range rasters</span></span>
<span><span class="co"># stack env covariates</span></span>
<span><span class="va">x_native_env_covariates</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_native_env_covariates_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># attributes</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">x_native_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_native_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">x_native_env_covariates</span><span class="op">)</span></span>
<span><span class="co"># ext(x_native_env_covariates)</span></span>
<span><span class="co"># crs(x_native_env_covariates)</span></span>
<span></span>
<span><span class="co"># I will change the name of the variables because they are throwing errors in SDMtune</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_native_env_covariates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">env_layer_names</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># global rasters</span></span>
<span><span class="co"># stack env covariates</span></span>
<span><span class="va">x_global_hist_env_covariates</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_global_hist_env_covariates_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># attributes</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">x_global_hist_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_hist_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">x_global_hist_env_covariates</span><span class="op">)</span></span>
<span><span class="co"># ext(x_global_hist_env_covariates)</span></span>
<span><span class="co"># crs(x_global_hist_env_covariates)</span></span>
<span></span>
<span><span class="co"># I will change the name of the variables because they are throwing errors in SDMtune</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_hist_env_covariates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">env_layer_names</span></span>
<span><span class="co"># confirmed- SDMtune doesnt like dashes in column names (it is read as a mathematical operation)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SSP126</span></span>
<span><span class="va">x_global_126_env_covariates</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_global_126_env_covariates_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># attributes</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">x_global_126_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_126_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">x_global_126_env_covariates</span><span class="op">)</span></span>
<span><span class="co"># ext(x_global_126_env_covariates)</span></span>
<span><span class="co"># crs(x_global_126_env_covariates)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_126_env_covariates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">env_layer_names</span></span>
<span></span>
<span></span>
<span><span class="co"># SSP370</span></span>
<span><span class="va">x_global_370_env_covariates</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_global_370_env_covariates_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># attributes</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">x_global_370_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_370_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">x_global_370_env_covariates</span><span class="op">)</span></span>
<span><span class="co"># ext(x_global_370_env_covariates)</span></span>
<span><span class="co"># crs(x_global_370_env_covariates)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_370_env_covariates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">env_layer_names</span></span>
<span></span>
<span></span>
<span><span class="co"># SSP585</span></span>
<span><span class="va">x_global_585_env_covariates</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_global_585_env_covariates_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># attributes</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">x_global_585_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_585_env_covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">x_global_585_env_covariates</span><span class="op">)</span></span>
<span><span class="co"># ext(x_global_585_env_covariates)</span></span>
<span><span class="co"># crs(x_global_585_env_covariates)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x_global_585_env_covariates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">env_layer_names</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x_native_env_covariates_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x_global_hist_env_covariates_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x_global_126_env_covariates_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x_global_370_env_covariates_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">x_global_585_env_covariates_list</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="input-data--presences-absences-training-and-testing">1.2 Input data- presences / absences (training and testing)<a class="anchor" aria-label="anchor" href="#input-data--presences-absences-training-and-testing"></a>
</h3>
<p>I need to also load in the SLF presence dataset created in vignette
030 and the background points dataset created in vignette 040.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># slf presences</span></span>
<span><span class="va">p_slf_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_all_coords_final_2024-08-05.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">species</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># training presences</span></span>
<span><span class="va">p_slf_points_native_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"regional_native_train_slf_presences_v3.csv"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># test presences</span></span>
<span><span class="va">p_slf_points_native_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"regional_native_test_slf_presences_v3.csv"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># entire eastern USA background point set</span></span>
<span><span class="va">a_regional_native_background_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"regional_native_background_points_v3.csv"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="model-training-object">Model Training object<a class="anchor" aria-label="anchor" href="#model-training-object"></a>
</h4>
<p>Now I will create the “samples with data” object that SDMtune
requires.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_native_train</span> <span class="op">&lt;-</span> <span class="fu">SDMtune</span><span class="fu">::</span><span class="fu"><a href="https://consbiol-unibern.github.io/SDMtune/reference/prepareSWD.html" class="external-link">prepareSWD</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="st">"Lycorma delicatula"</span>,</span>
<span>  env <span class="op">=</span> <span class="va">x_native_env_covariates</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_slf_points_native_train</span>, </span>
<span>  a <span class="op">=</span> <span class="va">a_regional_native_background_points</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># print helpful messages</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">regional_native_train</span><span class="op">@</span><span class="va">coords</span> <span class="co"># coordinates</span></span>
<span><span class="va">regional_native_train</span><span class="op">@</span><span class="va">pa</span> <span class="co"># presence / absence (background counted as absence)</span></span>
<span><span class="va">regional_native_train</span><span class="op">@</span><span class="va">data</span> <span class="co"># extracted data from </span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SDMtune</span><span class="fu">::</span><span class="fu"><a href="https://consbiol-unibern.github.io/SDMtune/reference/swd2csv.html" class="external-link">swd2csv</a></span><span class="op">(</span>swd <span class="op">=</span> <span class="va">regional_native_train</span>, file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"regional_native_train_slf_presences_with_data_v3.csv"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"regional_native_background_points_with_data_v3.csv"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="model-testing-object">Model testing object<a class="anchor" aria-label="anchor" href="#model-testing-object"></a>
</h4>
<p>The model will be tested using all presences from N America.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_native_test</span> <span class="op">&lt;-</span> <span class="fu">SDMtune</span><span class="fu">::</span><span class="fu"><a href="https://consbiol-unibern.github.io/SDMtune/reference/prepareSWD.html" class="external-link">prepareSWD</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="st">"Lycorma delicatula"</span>,</span>
<span>  env <span class="op">=</span> <span class="va">x_global_hist_env_covariates</span>, <span class="co"># need the global covariates for China and N America</span></span>
<span>  p <span class="op">=</span> <span class="va">p_slf_points_native_test</span>, </span>
<span>  a <span class="op">=</span> <span class="va">a_regional_native_background_points</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># print helpful messages</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">regional_native_test</span><span class="op">@</span><span class="va">coords</span> <span class="co"># coordinates</span></span>
<span><span class="va">regional_native_test</span><span class="op">@</span><span class="va">pa</span> <span class="co"># presence / absence (background counted as absence)</span></span>
<span><span class="va">regional_native_test</span><span class="op">@</span><span class="va">data</span> <span class="co"># extracted data from </span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">SDMtune</span><span class="fu">::</span><span class="fu"><a href="https://consbiol-unibern.github.io/SDMtune/reference/swd2csv.html" class="external-link">swd2csv</a></span><span class="op">(</span>swd <span class="op">=</span> <span class="va">regional_native_test</span>, file_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"regional_native_test_slf_presences_with_data_v3.csv"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"NULL.csv"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove second copy of background data points</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"NULL.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="train-native-regional-model">2. Train native Regional Model<a class="anchor" aria-label="anchor" href="#train-native-regional-model"></a>
</h2>
<p>First, I will train a maxEnt model. This and the other regional scale
model will NOT be cross-validated. Cross-validation randomly selects a
percentage of the presence data for training and testing, without regard
for spatial location. This process makes sense for the global model,
which is fed ALL presence data. Due to the spatial scale of the regional
models, it makes more sense to spatially separate the training and
testing data if given the opportunity.</p>
<p>I will use the following list of hyperparameters to train the initial
model, which I selected via tuning for the global model.</p>
<ul>
<li>ALL feature classes (fc) used (l = linear, q = quadratic, p =
product, h = hinge, t = threshold)</li>
<li>regularization multiplier (reg) set to 1.5 (more regularized than
default of 1)</li>
<li>iterations = 5000. This is the max number of iterations for the
optimization algorithm to perform before stopping training. Increasing
this number from the default of 500 allows the algorithm to make more
refined predictions.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_native_model</span> <span class="op">&lt;-</span> <span class="fu">SDMtune</span><span class="fu">::</span><span class="fu"><a href="https://consbiol-unibern.github.io/SDMtune/reference/train.html" class="external-link">train</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">"Maxent"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">regional_native_train</span>,</span>
<span>  fc <span class="op">=</span> <span class="st">"lqpht"</span>, <span class="co"># feature classes set to ALL</span></span>
<span>  reg <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">5000</span>, <span class="co"># number of iterations</span></span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="summary-statistics">Summary Statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a>
</h3>
<p>This function produces all summary statistics for this model. For the
complete and annotated workflow used to create this function, see
<code>051_compute_MaxEnt_summary_statistics_workflow.Rmd</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># output directory</span></span>
<span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/models/slf_regional_native_v3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">scari</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_MaxEnt_summary_statistics.html">compute_MaxEnt_summary_statistics</a></span><span class="op">(</span></span>
<span>  model.obj <span class="op">=</span> <span class="va">regional_native_model</span>, </span>
<span>  model.name <span class="op">=</span> <span class="st">"regional_native"</span>, </span>
<span>  mypath <span class="op">=</span> <span class="va">mypath</span>, </span>
<span>  create.dir <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># create subdirectory</span></span>
<span>  env.covar.obj <span class="op">=</span> <span class="va">x_native_env_covariates</span>, <span class="co"># env covariates raster stacked</span></span>
<span>  train.obj <span class="op">=</span> <span class="va">regional_native_train</span>, <span class="co"># training data used to create model</span></span>
<span>  test.obj <span class="op">=</span> <span class="va">regional_native_test</span>, <span class="co"># data you wish to use to test the model</span></span>
<span>  plot.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cloglog"</span>, <span class="st">"logistic"</span><span class="op">)</span>, <span class="co"># types of univariate and marginal response curves to be created</span></span>
<span>  jk.test.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"train"</span>, <span class="st">"test"</span><span class="op">)</span> <span class="co"># types of jackknife curves to be created</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="create-outputs-for-analysis">3. Create Outputs for Analysis<a class="anchor" aria-label="anchor" href="#create-outputs-for-analysis"></a>
</h2>
<div class="section level3">
<h3 id="create-distribution-map-for-area-of-interest">3.1 Create distribution map for area of interest<a class="anchor" aria-label="anchor" href="#create-distribution-map-for-area-of-interest"></a>
</h3>
<p>Lastly, I will use the <code>SDMtune::predict()</code> function to
predict the suitability for the range of interest. I will threshold the
map by the <code>MTP</code>, <code>MTSS</code> and
<code>10_percentile</code> thresholds. The workflow for this function is
wrapped into the function
<code><a href="../reference/create_MaxEnt_suitability_maps.html">create_MaxEnt_suitability_maps()</a></code>.</p>
<p>I will retrieve the specific value for the MTSS threshold for this
model and use it to define a what is considered unsuitable in this
raster. Then, I will reclassify the mean raster so that anything below
this threshold is now “unsuitable”. I will use the mean cloglog
threshold for all iterations. I will create a binary version of the mean
raster, with unsuitable regions, which are below the MTSS training
threshold, as 0, and those above the threshold as 1. Then, I can
reclassify averaged raster of MaxEnt predictions. I will load in the
averaged prediction for this model and reclassify the raster using a
temporary raster layer that I will create. This raster will only have
values where the model predicts the climate to be unsuitable, so that it
can be plotted overtop the averaged raster to mask unsuitable areas</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/models/slf_regional_native_v3"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_native_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"regional_native_model.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">scari</span><span class="fu">::</span><span class="fu"><a href="../reference/create_MaxEnt_suitability_maps.html">create_MaxEnt_suitability_maps</a></span><span class="op">(</span></span>
<span>  model.obj <span class="op">=</span> <span class="va">regional_native_model</span>,</span>
<span>  model.name <span class="op">=</span> <span class="st">"regional_native"</span>, </span>
<span>  mypath <span class="op">=</span> <span class="va">mypath</span>, </span>
<span>  create.dir <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>  env.covar.obj <span class="op">=</span> <span class="va">x_global_hist_env_covariates</span>, </span>
<span>  describe.proj <span class="op">=</span> <span class="st">"globe_1981-2010"</span>, <span class="co"># name of area or time period describe.proj to</span></span>
<span>  clamp.pred <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  map.thresh <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># whether thresholded versions of these maps should be created</span></span>
<span>  map.thresh.extra <span class="op">=</span> <span class="st">"MTP"</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MTP"</span>, <span class="st">"10_percentile"</span>, <span class="st">"MTSS"</span><span class="op">)</span>,</span>
<span>  summary.file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"regional_native_summary.csv"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>I will also create suitability maps for the projected 2041-2070
climate data.</p>
<!--


``` r
scari::create_MaxEnt_suitability_maps(
  model.obj = regional_native_model,
  model.name = "regional_native", 
  mypath = mypath, 
  create.dir = FALSE, 
  env.covar.obj = x_global_126_env_covariates, 
  describe.proj = "globe_2041-2070_GFDL_ssp126", # name of area or time period projected to
  clamp.pred = TRUE,
  thresh = c("MTP", "10_percentile", "MTSS"),
  map.thresh = TRUE, # whether thresholded versions of these maps should be created
  map.thresh.extra = "MTP",
  summary.file = file.path(mypath, "regional_native_summary.csv")
)
```


``` r
scari::create_MaxEnt_suitability_maps(
  model.obj = regional_native_model,
  model.name = "regional_native", 
  mypath = mypath, 
  create.dir = FALSE, 
  env.covar.obj = x_global_370_env_covariates, 
  describe.proj = "globe_2041-2070_GFDL_ssp370", # name of area or time period projected to
  clamp.pred = TRUE,
  thresh = c("MTP", "10_percentile", "MTSS"),
  map.thresh = TRUE, # whether thresholded versions of these maps should be created
  map.thresh.extra = "MTP",
  summary.file = file.path(mypath, "regional_native_summary.csv")
)
```


``` r
scari::create_MaxEnt_suitability_maps(
  model.obj = regional_native_model,
  model.name = "regional_native", 
  mypath = mypath, 
  create.dir = FALSE, 
  env.covar.obj = x_global_585_env_covariates, 
  describe.proj = "globe_2041-2070_GFDL_ssp585", # name of area or time period projected to
  clamp.pred = TRUE,
  thresh = c("MTP", "10_percentile", "MTSS"),
  map.thresh = TRUE, # whether thresholded versions of these maps should be created
  map.thresh.extra = "MTP",
  summary.file = file.path(mypath, "regional_native_summary.csv")
)
```

-->
</div>
<div class="section level3">
<h3 id="predict-suitability-for-all-slf-presences">3.2 Predict suitability for all SLF presences<a class="anchor" aria-label="anchor" href="#predict-suitability-for-all-slf-presences"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/models/slf_regional_native_v3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># slf presence data</span></span>
<span><span class="va">slf_presences</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_all_coords_final_2024-08-05.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">species</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">scari</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_xy_suitability.html">predict_xy_suitability</a></span><span class="op">(</span></span>
<span>  xy.obj <span class="op">=</span> <span class="va">slf_presences</span>,</span>
<span>  xy.type <span class="op">=</span> <span class="st">"Lycorma delicatula"</span>,</span>
<span>  env.covar.obj <span class="op">=</span> <span class="va">x_global_hist_env_covariates</span>,</span>
<span>  model.obj <span class="op">=</span> <span class="va">regional_native_model</span>,</span>
<span>  mypath <span class="op">=</span> <span class="va">mypath</span>,</span>
<span>  predict.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cloglog"</span>, <span class="st">"logistic"</span><span class="op">)</span>,</span>
<span>  output.name <span class="op">=</span> <span class="st">"regional_native_slf_all_coords_1981-2010"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<!--

I will repeat the same process for the CMIP6 data.


``` r
scari::predict_xy_suitability(
  xy.obj = slf_presences,
  xy.type = "Lycorma delicatula",
  env.covar.obj = x_global_126_env_covariates,
  model.obj = regional_native_model,
  mypath = mypath,
  predict.type = c("cloglog", "logistic"),
  output.name = "regional_native_slf_all_coords_2041-2070_GFDL_ssp126"
)
```


``` r
scari::predict_xy_suitability(
  xy.obj = slf_presences,
  xy.type = "Lycorma delicatula",
  env.covar.obj = x_global_370_env_covariates,
  model.obj = regional_native_model,
  mypath = mypath,
  predict.type = c("cloglog", "logistic"),
  output.name = "regional_native_slf_all_coords_2041-2070_GFDL_ssp370"
)
```


``` r
scari::predict_xy_suitability(
  xy.obj = slf_presences,
  xy.type = "Lycorma delicatula",
  env.covar.obj = x_global_585_env_covariates,
  model.obj = regional_native_model,
  mypath = mypath,
  predict.type = c("cloglog", "logistic"),
  output.name = "regional_native_slf_all_coords_2041-2070_GFDL_ssp585"
)
```

-->
</div>
<div class="section level3">
<h3 id="predict-suibability-for-ivr-regions">3.3 Predict suibability for IVR regions<a class="anchor" aria-label="anchor" href="#predict-suibability-for-ivr-regions"></a>
</h3>
<p>I will perform the same action as above, but for the locations of
important wineries around the world.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/models/slf_regional_native_v3"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in all IVR points</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/renv/reference/load.html" class="external-link">load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data"</span>, <span class="st">"wineries.rda"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">IVR_regions</span> <span class="op">&lt;-</span> <span class="va">wineries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">scari</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_xy_suitability.html">predict_xy_suitability</a></span><span class="op">(</span></span>
<span>  xy.obj <span class="op">=</span> <span class="va">IVR_regions</span>,</span>
<span>  xy.type <span class="op">=</span> <span class="st">"IVR regions"</span>,</span>
<span>  env.covar.obj <span class="op">=</span> <span class="va">x_global_hist_env_covariates</span>,</span>
<span>  model.obj <span class="op">=</span> <span class="va">regional_native_model</span>,</span>
<span>  mypath <span class="op">=</span> <span class="va">mypath</span>,</span>
<span>  predict.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cloglog"</span>, <span class="st">"logistic"</span><span class="op">)</span>,</span>
<span>  output.name <span class="op">=</span> <span class="st">"regional_native_wineries_1981-2010"</span>,</span>
<span>  buffer.pred <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<!--

Do the same for the SSP scenarios


``` r
scari::predict_xy_suitability(
  xy.obj = IVR_regions,
  xy.type = "IVR regions",
  env.covar.obj = x_global_126_env_covariates,
  model.obj = regional_native_model,
  mypath = mypath,
  predict.type = c("cloglog", "logistic"),
  output.name = "regional_native_wineries_2041-2070_GFDL_ssp126",
  buffer.pred = TRUE
)
```


``` r
scari::predict_xy_suitability(
  xy.obj = IVR_regions,
  xy.type = "IVR regions",
  env.covar.obj = x_global_370_env_covariates,
  model.obj = regional_native_model,
  mypath = mypath,
  predict.type = c("cloglog", "logistic"),
  output.name = "regional_native_wineries_2041-2070_GFDL_ssp370",
  buffer.pred = TRUE
)
```


``` r
scari::predict_xy_suitability(
  xy.obj = IVR_regions,
  xy.type = "IVR regions",
  env.covar.obj = x_global_585_env_covariates,
  model.obj = regional_native_model,
  mypath = mypath,
  predict.type = c("cloglog", "logistic"),
  output.name = "regional_native_wineries_2041-2070_GFDL_ssp585",
  buffer.pred = TRUE
)
```

-->
<p>Now that all of my models have been trained, I can move on to make
check for the level of extrapolation (exdet) and the most important
covariate (MIC) for each model’s predictions. This is an important step
when applying models to climate change and invasive species, due to the
non-equilibrium nature of these applications.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Elith, J., Phillips, S. J., Hastie, T., Dudík, M., Chee, Y. E.,
&amp; Yates, C. J. (2011). A statistical explanation of MaxEnt for
ecologists: Statistical explanation of MaxEnt. Diversity and
Distributions, 17(1), 43–57. <a href="https://doi.org/10.1111/j.1472-4642.2010.00725.x" class="external-link uri">https://doi.org/10.1111/j.1472-4642.2010.00725.x</a></p></li>
<li><p>Feng, X. (2022). Shandongfx/nimbios_enm [HTML]. <a href="https://github.com/shandongfx/nimbios_enm" class="external-link uri">https://github.com/shandongfx/nimbios_enm</a> (Original work
published 2018).</p></li>
<li><p>Gallien, L., Douzet, R., Pratte, S., Zimmermann, N. E., &amp;
Thuiller, W. (2012). Invasive species distribution models – how
violating the equilibrium assumption can create new insights. Global
Ecology and Biogeography, 21(11), 1126–1136. <a href="https://doi.org/10.1111/j.1466-8238.2012.00768.x" class="external-link uri">https://doi.org/10.1111/j.1466-8238.2012.00768.x</a></p></li>
<li><p>Maryam Bordkhani. (n.d.). Threshold rule [Online post].</p></li>
<li><p>Radosavljevic, A., &amp; Anderson, R. P. (2014). Making better
Maxent models of species distributions: Complexity, overfitting and
evaluation. Journal of Biogeography, 41(4), 629–643. <a href="https://doi.org/10.1111/jbi.12227" class="external-link uri">https://doi.org/10.1111/jbi.12227</a></p></li>
<li><p>Sobek-Swant, S., Kluza, D. A., Cuddington, K., &amp; Lyons, D. B.
(2012). Potential distribution of emerald ash borer: What can we learn
from ecological niche models using Maxent and GARP? Forest Ecology and
Management, 281, 23–31. <a href="https://doi.org/10.1016/j.foreco.2012.06.017" class="external-link uri">https://doi.org/10.1016/j.foreco.2012.06.017</a></p></li>
<li><p>Phillips, S. J., Anderson, R. P., &amp; Schapire, R. E. (2006).
Maximum entropy modeling of species geographic distributions. Ecological
Modelling, 190(3), 231–259. <a href="https://doi.org/10.1016/j.ecolmodel.2005.03.026" class="external-link uri">https://doi.org/10.1016/j.ecolmodel.2005.03.026</a></p></li>
<li><p>Steven Phillips. (2017). A Brief Tutorial on Maxent. <a href="http://biodiversityinformatics.amnh.org/open_source/maxent/" class="external-link uri">http://biodiversityinformatics.amnh.org/open_source/maxent/</a>.</p></li>
<li><p>Steven J. Phillips, Miroslav Dudík, &amp; Robert E. Schapire.
(2023). Maxent software for modeling species niches and distributions
(Version 3.4.3 (Java)) [Computer software]. <a href="http://biodiversityinformatics.amnh.org/open_source/maxent/" class="external-link uri">http://biodiversityinformatics.amnh.org/open_source/maxent/</a>.</p></li>
<li><p>Srivastava, V., Roe, A. D., Keena, M. A., Hamelin, R. C., &amp;
Griess, V. C. (2021). Oh the places they’ll go: Improving species
distribution modelling for invasive forest pests in an uncertain world.
Biological Invasions, 23(1), 297–349. <a href="https://doi.org/10.1007/s10530-020-02372-9" class="external-link uri">https://doi.org/10.1007/s10530-020-02372-9</a></p></li>
<li><p>VanDerWal, J., Shoo, L. P., Graham, C., &amp; Williams, S. E.
(2009). Selecting pseudo-absence data for presence-only distribution
modeling: How far should you stray from what you know? Ecological
Modelling, 220(4), 589–594. <a href="https://doi.org/10.1016/j.ecolmodel.2008.11.010" class="external-link uri">https://doi.org/10.1016/j.ecolmodel.2008.11.010</a></p></li>
<li><p>Vignali, S., Barras, A. G., Arlettaz, R., &amp; Braunisch, V.
(2020). SDMtune: An R package to tune and evaluate species distribution
models. Ecology and Evolution, 10(20), 11488–11506. <a href="https://doi.org/10.1002/ece3.6786" class="external-link uri">https://doi.org/10.1002/ece3.6786</a></p></li>
</ol>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel M. Owens, Matthew R. Helmus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
