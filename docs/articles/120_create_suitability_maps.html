<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Map regional ensemble predictions and intercept with global model • slfSpread</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map regional ensemble predictions and intercept with global model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">slfSpread</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/slfSpread.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quantify risk to specific viticultural regions</h6></li>
    <li><a class="dropdown-item" href="../articles/150_create_risk_report.html">Example usage of create_risk_report.R to create reports of key viticultural areas</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Initialize slfSpread</h6></li>
    <li><a class="dropdown-item" href="../articles/010_initialize_pkg.html">Initialization of renv package for dependencies</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>1. Retrieve and tidy input data for MaxEnt</h6></li>
    <li><a class="dropdown-item" href="../articles/020_retrieve_SLF_records.html">Retrieve SLF records from various sources and tidy them for MaxEnt modeling</a></li>
    <li><a class="dropdown-item" href="../articles/030_retrieve_bioclim_variables.html">Retrieve bioclim rasters from CHELSA and tidy them for MaxEnt modeling</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>2. SDM modeling pipeline</h6></li>
    <li><a class="dropdown-item" href="../articles/040_setup_global_MaxEnt_model.html">Setup for global-scale MaxEnt model</a></li>
    <li><a class="dropdown-item" href="../articles/050_run_global_MaxEnt_model.html">Run global-scale MaxEnt model</a></li>
    <li><a class="dropdown-item" href="../articles/060_setup_regional_MaxEnt_models.html">Setup for regional-scale MaxEnt models</a></li>
    <li><a class="dropdown-item" href="../articles/070_run_regional_invaded_MaxEnt_model.html">Run 'Ri.NAmerica' model trained on SLF invaded region in North America</a></li>
    <li><a class="dropdown-item" href="../articles/080_run_regional_invaded_asian_MaxEnt_model.html">Run 'Ri.Asia' model trained on SLF invaded range in Japan and South Korea</a></li>
    <li><a class="dropdown-item" href="../articles/090_run_regional_native_MaxEnt_model.html">Run 'Rn' model trained on SLF native range in east Asia</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>3. Ensemble Regional-scale SDMs</h6></li>
    <li><a class="dropdown-item" href="../articles/100_run_ExDet_MIC.html">Run an Extrapolation Detection (NT2) analysis and calculate MIC</a></li>
    <li><a class="dropdown-item" href="../articles/110_ensemble_regional_models.html">Ensemble regional-scale models into a single prediction</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>4. Quantify SLF risk and model fit</h6></li>
    <li><a class="dropdown-item" href="../articles/120_create_suitability_maps.html">Map regional ensemble predictions and intercept with global model</a></li>
    <li><a class="dropdown-item" href="../articles/130_create_suitability_xy_plots_viticultural.html">Plot shift in SLF suitability for important viticultural regions under climate change</a></li>
    <li><a class="dropdown-item" href="../articles/131_create_suitability_xy_plots_SLF.html">Plot stability of known SLF populations due climate change effects</a></li>
    <li><a class="dropdown-item" href="../articles/140_plot_response_curves.html">Plot response curves</a></li>
    <li><a class="dropdown-item" href="../articles/141_plot_AUC_var_cont.html">Plot AUC curves and variable contribution graphs</a></li>
    <li><a class="dropdown-item" href="../articles/142_calculate_model_fit.html">Calculate model fit statistics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ieco-lab/slfSpread/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Map regional ensemble predictions and intercept with global model</h1>
                        <h4 data-toc-skip class="author">Samuel M.
Owens<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Temple University, &lt;a href="mailto:sam.owens@temple.edu" class="email"&gt;sam.owens@temple.edu&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">2024-08-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ieco-lab/slfSpread/blob/HEAD/vignettes/120_create_suitability_maps.Rmd" class="external-link"><code>vignettes/120_create_suitability_maps.Rmd</code></a></small>
      <div class="d-none name"><code>120_create_suitability_maps.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In the last vignette, I applied a weighting factor to the three
regional-scale models to create an ensembled mean prediction. I have
already created a global-scale model prediction, so now that the
regional-scale models have been ensembled, I can directly compare the
predictions made by the two modeled scales. Each model in this
multi-scale analysis has been projected to the entire globe, so I can
now measure the differences between these two models. My goals for
application of these models are to look at the predictions for SLF risk
of establishment made (A) spatially for globally important winegrowing
countries, (B) at the specific locations of globally important
viticultural regions, and (C) at the location of known SLF populations.
I plan to explore the suitability for SLF via creating a range of
outputs:</p>
<ol style="list-style-type: decimal">
<li>risk maps</li>
<li>range shift maps</li>
<li>viticultural risk quadrant plots</li>
<li>viticultural risk tables</li>
<li>variable response curves</li>
<li>other summary statistics, including AUC and variable
contribution</li>
</ol>
<p>In this vignette, I will create all mapping outputs to depict the
risk of SLF establishment both historically and under future climate
scenarios. I will also create a range shift map to show the expansion
and contraction of suitable area under climate change. I will create
these maps by intersecting the global and regional_ensemble model
predictions to create classified (binarized) rasters. The level of
agreement between each model prediction will be used to infer the level
of SLF establishment risk.</p>
<p>The process will follow this general flow for creating the risk
maps:</p>
<ol style="list-style-type: decimal">
<li>Create suitable vs unsuitable classes based on the MTSS threshold of
both rasters</li>
<li>Convert each model raster to binary (suitable/unsuitable) based on
these suitability thresholds</li>
<li>Mosaic the two rasters and sum their values.</li>
<li>Re-classify summed raster as areas where both agree on presence,
both agree on absence, or one classifies and the other classifies absent
(4 total categories)</li>
</ol>
<p>I created a consensus MTSS threshold for each model in the previous
vignette, which I will use to binarize these rasters. This procedure
will be repeated for each ssp scenario and then a mean of the scenarios
to produce different predictions based on different climate scenarios. I
will also calculate the total area per risk category and raster to show
how the change in suitable area might change depending on the ssp
scenario.</p>
<p>Finally, I will plot a range shift map to show the expansion and
contraction of suitable area per ssp scenario (essentially, the
difference between the historical and future predictions).</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># general tools</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>  <span class="co">#data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span> <span class="co">#making directory pathways easier on different instances</span></span>
<span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># here() starts at the root folder of this package.</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "C:/Users/tun83449/Documents/GitHub/slfSpread"</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://common.r-sassy.org" class="external-link">common</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># spatial data handling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># aesthetics</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wch.github.io/webshot/" class="external-link">webshot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/webshot2/" class="external-link">webshot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> I will be setting the global options of this
document so that only certain code chunks are rendered in the final
.html file. I will set the <code>eval = FALSE</code> so that none of the
code is re-run (preventing files from being overwritten during knitting)
and will simply overwrite this in chunks with plots.</p>
<p>I will load in preset styles for the maps. The regular map_style will
be for the continuous suitability maps, while map_style_binarized will
be used for specialized binary overlay maps between the regional
ensemble and the global models.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_style</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"longitude"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"latitude"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># legend</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">15</span>, b <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, angle <span class="op">=</span> <span class="fl">35</span><span class="op">)</span>,</span>
<span>    <span class="co"># background</span></span>
<span>    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue2"</span>,</span>
<span>                                        colour <span class="op">=</span> <span class="st">"lightblue2"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Suitability for SLF \n(cloglog)"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_style_binarized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"longitude"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"latitude"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># legend</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    <span class="co"># background</span></span>
<span>    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue2"</span>,</span>
<span>                                        colour <span class="op">=</span> <span class="st">"lightblue2"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     <span class="st">"maxent/models"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-datasets">Import datasets<a class="anchor" aria-label="anchor" href="#import-datasets"></a>
</h2>
<p>I will import the predicted suitability rasters and MTSS thresholds
from each of the models. I will stack these rasters and harmonize their
naming.</p>
<div class="section level3">
<h3 id="regional-ensemble">regional ensemble<a class="anchor" aria-label="anchor" href="#regional-ensemble"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># historical </span></span>
<span><span class="va">regional_ensemble_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"ensemble_regional_weighted_mean_globe_1981-2010.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># CMIP6</span></span>
<span><span class="co"># ssp126</span></span>
<span><span class="va">regional_ensemble_2055_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"ensemble_regional_weighted_mean_globe_2041-2070_GFDL_ssp126.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># ssp370</span></span>
<span><span class="va">regional_ensemble_2055_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"ensemble_regional_weighted_mean_globe_2041-2070_GFDL_ssp370.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># ssp585</span></span>
<span><span class="va">regional_ensemble_2055_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"ensemble_regional_weighted_mean_globe_2041-2070_GFDL_ssp585.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># the mean of the ssp scenarios</span></span>
<span><span class="va">regional_ensemble_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"ensemble_regional_weighted_mean_globe_2041-2070_GFDL_ssp_averaged.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_ensemble_thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"ensemble_threshold_values.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change names</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regional_ensemble_1995</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ensemble_suitability"</span></span>
<span><span class="co"># CMIP6</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_126</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ensemble_suitability"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_370</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ensemble_suitability"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_585</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ensemble_suitability"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_ssp_mean</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ensemble_suitability"</span></span>
<span></span>
<span><span class="co"># also convert to df</span></span>
<span><span class="va">regional_ensemble_1995_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">regional_ensemble_1995</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># CMIP6</span></span>
<span><span class="va">regional_ensemble_2055_126_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_126</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">regional_ensemble_2055_370_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_370</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">regional_ensemble_2055_585_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_585</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">regional_ensemble_2055_ssp_mean_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_ssp_mean</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="global-model">Global model<a class="anchor" aria-label="anchor" href="#global-model"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># historical </span></span>
<span><span class="va">global_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"global_pred_suit_clamped_cloglog_globe_1981-2010_mean.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># CMIP6</span></span>
<span><span class="co"># ssp126</span></span>
<span><span class="va">global_2055_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"global_pred_suit_clamped_cloglog_globe_2041-2070_GFDL_ssp126_mean.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># ssp370</span></span>
<span><span class="va">global_2055_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"global_pred_suit_clamped_cloglog_globe_2041-2070_GFDL_ssp370_mean.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># ssp126</span></span>
<span><span class="va">global_2055_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"global_pred_suit_clamped_cloglog_globe_2041-2070_GFDL_ssp585_mean.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># also import mean raster</span></span>
<span><span class="va">global_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"global_pred_suit_clamped_cloglog_globe_2041-2070_GFDL_ssp_averaged.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_global</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"global_summary_all_iterations.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">statistic</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change names</span></span>
<span><span class="co"># historical</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">global_1995</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_suitability"</span></span>
<span><span class="co"># CMIP6</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">global_2055_126</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_suitability"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">global_2055_370</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_suitability"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">global_2055_585</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_suitability"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">global_2055_ssp_mean</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_suitability"</span></span>
<span></span>
<span><span class="co"># also convert to df</span></span>
<span><span class="va">global_1995_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">global_1995</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># CMIP6</span></span>
<span><span class="va">global_2055_126_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">global_2055_126</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">global_2055_370_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">global_2055_370</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">global_2055_585_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">global_2055_585</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">global_2055_ssp_mean_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">global_2055_ssp_mean</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="map-cloglog-suitability">1. Map cloglog suitability<a class="anchor" aria-label="anchor" href="#map-cloglog-suitability"></a>
</h2>
<p>Before I binarize these mapped predictions, I will plot raw
suitability maps from each of the models.</p>
<div class="section level3">
<h3 id="mapping-helper-function">1.1 Mapping helper function<a class="anchor" aria-label="anchor" href="#mapping-helper-function"></a>
</h3>
<p>I will try to reduce the amount of repeated code by using a mapping
helper function containing the body of the plotting code. This part will
remain relatively unchanged each time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_cloglog_output</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">raster.df</span>, <span class="va">raster.value.name</span>, <span class="va">thresh.MTP</span>, <span class="va">thresh.MTSS</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># raster.df = the dataframe of the raster</span></span>
<span>  <span class="co"># raster.value.name = the name of the raster values</span></span>
<span>  <span class="co"># thresh.MTP = the df cell coordinates of the MTP thresh</span></span>
<span>  <span class="co"># thresh.MTSS = the df cell coordinates of the MTSS thresh</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># default style object</span></span>
<span>    <span class="va">map_style</span> <span class="op">+</span></span>
<span>    <span class="co"># plot raster</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raster.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">raster.value.name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># aesthetics</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span></span>
<span>      <span class="co"># the values of the color divisions: 0, MTP, slightly above MTP, MTSS, slightly above MTSS, 0.5, 0.75, 1</span></span>
<span>      values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="fl">0</span>, <span class="co"># minimum</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTP</span><span class="op">)</span>, <span class="co"># MTP thresh</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTP</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0000001</span>, <span class="co"># some small amount more than the MTP</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTSS</span><span class="op">)</span>, <span class="co"># MTSS thresh</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTSS</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0000001</span>,</span>
<span>        <span class="co"># the rest</span></span>
<span>        <span class="fl">0.5</span>,</span>
<span>        <span class="fl">0.75</span>,</span>
<span>        <span class="fl">1</span></span>
<span>        <span class="op">)</span>,</span>
<span>      <span class="co"># these colors taken from viridis color scale D</span></span>
<span>      <span class="co"># the colors for the divisions in the order: 0, MTP, slightly above MTP, MTSS, slightly above MTSS, 0.5, 0.75, 1</span></span>
<span>      colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"azure4"</span>, <span class="st">"azure4"</span>, <span class="st">"azure2"</span>, <span class="st">"azure2"</span>, <span class="st">"#481567FF"</span>, <span class="st">"#2D708EFF"</span>, <span class="st">"#3CBB75FF"</span>, <span class="st">"#FDE725FF"</span><span class="op">)</span>,</span>
<span>      <span class="co"># the tick marks</span></span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTP</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTSS</span><span class="op">)</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span><span class="op">)</span>,</span>
<span>      <span class="co"># labels for the tick marks</span></span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unsuitable"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/math-generics.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh.MTSS</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n(MTSS thresh)"</span><span class="op">)</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.0</span><span class="op">)</span>,</span>
<span>      guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span>frame.colour <span class="op">=</span> <span class="st">"black"</span>, ticks.colour <span class="op">=</span> <span class="st">"black"</span>, barwidth <span class="op">=</span> <span class="fl">20</span>, draw.ulim <span class="op">=</span> <span class="cn">TRUE</span>, draw.llim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="op">)</span> </span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="map-cloglog-output-of-models--historical">1.2 Map cloglog output of models- historical<a class="anchor" aria-label="anchor" href="#map-cloglog-output-of-models--historical"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_ensemble_1995_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">regional_ensemble_1995_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">regional_ensemble_1995_df</span><span class="op">$</span><span class="va">ensemble_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in regional model ensemble"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"1981-2010"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">regional_ensemble_1995_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"plots"</span>, <span class="st">"regional_ensemble_pred_suit_globe_1981-2010.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_1995_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">global_1995_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">global_1995_df</span><span class="op">$</span><span class="va">global_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in global model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"1981-2010"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">global_1995_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"plots"</span>, <span class="st">"global_pred_suit_globe_1981-2010.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>I will repeat the same process to map the predictions for each ssp
scenario for 2041-2070. I will also mean these scenarios for a final
prediction under climate change.</p>
</div>
<div class="section level3">
<h3 id="map-cloglog-output-of-models--cmip6">1.3 Map cloglog output of models- CMIP6<a class="anchor" aria-label="anchor" href="#map-cloglog-output-of-models--cmip6"></a>
</h3>
<div class="section level4">
<h4 class="hidden" id="ssp-126">ssp 126<a class="anchor" aria-label="anchor" href="#ssp-126"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regional_ensemble_2055_126_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">regional_ensemble_2055_126_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">regional_ensemble_2055_126_df</span><span class="op">$</span><span class="va">ensemble_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">7</span>, <span class="fl">4</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in regional model ensemble"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp126 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">regional_ensemble_2055_126_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"plots"</span>, <span class="st">"regional_ensemble_pred_suit_globe_2041-2070_GFDL_ssp126.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I had to change the row call of the thresholds tibble to row 2 [2, x]</span></span>
<span></span>
<span><span class="va">global_2055_126_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">global_2055_126_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">global_2055_126_df</span><span class="op">$</span><span class="va">global_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in global model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp126 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_126_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"plots"</span>, <span class="st">"global_pred_suit_globe_2041-2070_GFDL_ssp126.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp-370">ssp 370<a class="anchor" aria-label="anchor" href="#ssp-370"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I had to change the row call of the thresholds tibble to row 2 [2, x]</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_370_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">regional_ensemble_2055_370_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">regional_ensemble_2055_370_df</span><span class="op">$</span><span class="va">ensemble_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in regional model ensemble"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp370 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">regional_ensemble_2055_370_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"plots"</span>, <span class="st">"regional_ensemble_pred_suit_globe_2041-2070_GFDL_ssp370.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I had to change the row call of the thresholds tibble to row 2 [2, x]</span></span>
<span></span>
<span><span class="va">global_2055_370_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">global_2055_370_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">global_2055_370_df</span><span class="op">$</span><span class="va">global_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in global model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp370 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_370_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"plots"</span>, <span class="st">"global_pred_suit_globe_2041-2070_GFDL_ssp370.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp-585">ssp 585<a class="anchor" aria-label="anchor" href="#ssp-585"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I had to change the row call of the thresholds tibble to row 2 [2, x]</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_585_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">regional_ensemble_2055_585_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">regional_ensemble_2055_585_df</span><span class="op">$</span><span class="va">ensemble_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">9</span>, <span class="fl">4</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in regional model ensemble"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp585 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">regional_ensemble_2055_585_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"plots"</span>, <span class="st">"regional_ensemble_pred_suit_globe_2041-2070_GFDL_ssp585.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_2055_585_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">global_2055_585_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">global_2055_585_df</span><span class="op">$</span><span class="va">global_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in global model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp585 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_585_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"plots"</span>, <span class="st">"global_pred_suit_globe_2041-2070_GFDL_ssp585.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ssp-mean">ssp mean<a class="anchor" aria-label="anchor" href="#ssp-mean"></a>
</h4>
<p>Finally, I will plot the mean of the three ssp scenarios.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># I had to change the row call of the thresholds tibble to row 2 [2, x]</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_ssp_mean_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">regional_ensemble_2055_ssp_mean_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">regional_ensemble_2055_ssp_mean_df</span><span class="op">$</span><span class="va">ensemble_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">5</span>, <span class="fl">4</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in regional model ensemble"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | mean of ssp126, 370, 585 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">regional_ensemble_2055_ssp_mean_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_regional_ensemble_v1"</span>, <span class="st">"plots"</span>, <span class="st">"regional_ensemble_pred_suit_globe_2041-2070_GFDL_ssp_mean.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_2055_ssp_mean_plot</span> <span class="op">&lt;-</span> <span class="fu">map_cloglog_output</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">global_2055_ssp_mean_df</span>, <span class="co"># the dataframe of the raster</span></span>
<span>  raster.value.name <span class="op">=</span> <span class="va">global_2055_ssp_mean_df</span><span class="op">$</span><span class="va">global_suitability</span>, <span class="co"># the name of the raster values</span></span>
<span>  thresh.MTP <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">]</span>, <span class="co"># the df cell coordinates of the MTP thresh</span></span>
<span>  thresh.MTSS <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span> <span class="co"># the df cell coordinates of the MTSS thresh</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labs</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Suitability for SLF in global model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | mean of ssp126, 370, 585 GFDL-ESM4"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"MTP &amp; MTSS thresholds | clamped"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_ssp_mean_plot</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"slf_global_v3"</span>, <span class="st">"plots"</span>, <span class="st">"global_pred_suit_globe_2041-2070_GFDL_ssp_mean.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="create-binary-threshold-maps-to-infer-range-filling">2. Create binary threshold maps to infer range filling<a class="anchor" aria-label="anchor" href="#create-binary-threshold-maps-to-infer-range-filling"></a>
</h2>
<p>Now that I have an idea of what the suitability maps look like before
conversion, I will reclassify and combine these maps. I will create
matrix objects that will be used to reclassify the output rasters to a
binary predictor of suitability. I will use the MTSS (““Maximum Test
Sensitivity Plus Specificity”) threshold for each model as the threshold
for suitability, with anything below this threshold being considered
unsuitable for SLF establishment.</p>
<p>To reclassify, package terra takes a 3-column matrix for its
<code><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify()</a></code> function, which re-classifies groups of values
to a single value. I will reclassify anything below the MTSS threshold
as one value, and anything above as another.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_global</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 52 × 2</span></span></span>
<span><span class="co">##    statistic                        mean</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> X.Training.samples            578.   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Regularized.training.gain       3.34 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Unregularized.training.gain     3.78 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Iterations                   <span style="text-decoration: underline;">1</span>818    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Training.AUC                    0.986</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> X.Background.points         <span style="text-decoration: underline;">20</span>000    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> bio11.contribution             58.8  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> bio12.contribution             19.3  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> bio15.contribution             15.6  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> bio2.contribution               6.34 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 42 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MTSS value is 0.041</span></span>
<span></span>
<span><span class="va">regional_ensemble_thresholds</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">##    thresh time_period CMIP6_model         value</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> MTP    1981-2010   <span style="color: #BB0000;">NA</span>                 0.012<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> MTP    2041-2070   ssp126_GFDL        0.012<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> MTP    2041-2070   ssp370_GFDL        0.012<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> MTP    2041-2070   ssp585_GFDL        0.012<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> MTP    2041-2070   ssp_mean_GFDL-ESM4 0.012<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> MTSS   1981-2010   <span style="color: #BB0000;">NA</span>                 0.241 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> MTSS   2041-2070   ssp126_GFDL        0.241 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> MTSS   2041-2070   ssp370_GFDL        0.241 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> MTSS   2041-2070   ssp585_GFDL        0.241 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> MTSS   2041-2070   ssp_mean_GFDL-ESM4 0.241</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MTSS value is ~0.241</span></span></code></pre></div>
<p>I will create separate classification matrices for each of the global
and regional-scale ensemble outputs. The reason for having two separate
matrices is because I will need to differentiate between a “suitable”
spot on the global and regional rasters. Base-2 binary offers an
intuitive system for creating these class differences. I will encode the
rasters into base-2 binary so that the end result is 4 categories of
values (the idea for this was found in <a href="https://gis.stackexchange.com/questions/127055/comparing-and-finding-inaccuracies-in-two-raster-layers" class="external-link">this
forum</a>).<br></p>
<p>I will encode the cloglog output of MaxEnt into these values:</p>
<table class="table">
<thead><tr class="header">
<th>Model and suitability</th>
<th>cloglog range</th>
<th>binary value</th>
<th>output value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Regional unsuitable</td>
<td>0 - 0.241</td>
<td>00000001</td>
<td>1</td>
</tr>
<tr class="even">
<td>Regional suitable</td>
<td>0.2411 - 1</td>
<td>00000010</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Global unsuitable</td>
<td>0 - 0.041</td>
<td>00000100</td>
<td>4</td>
</tr>
<tr class="even">
<td>Global suitable</td>
<td>0.0411 - 1</td>
<td>00001000</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>By encoding the rasters into base-2, I have created only 4 possible
values of the raster layers, which can be translated into 4
categories:</p>
<ul>
<li>Unsuitable Agreement = 5 (00000101)</li>
<li>Suitable Agreement = 10 (00001010)</li>
<li>unsuitable regional/suitable global = 9 (00001001)</li>
<li>Suitable regional/unsuitable global = 6 (00000110)</li>
</ul>
<p>I will also interpret these categories in terms of risk of SLF
suitability. These categories can be thought of as:</p>
<p><em>Unsuitable Agreement = low risk </em>Suitable Agreement = high
risk <em>Suitable regional/unsuitable global = adaptive risk
</em>unsuitable regional/suitable global = imminent risk</p>
<p>Gallien et al, 2012 interprets these categories in terms of specific
ecological mechanisms, but we prefer to interpret them in terms of the
risk for SLF.</p>
<div class="section level3">
<h3 id="convert-output-rasters-to-binary-predictors">2.1 convert output rasters to binary predictors<a class="anchor" aria-label="anchor" href="#convert-output-rasters-to-binary-predictors"></a>
</h3>
<p>I will walk through this workflow initially, but will functionalize
it after this to avoid repeating it four more times.</p>
<div class="section level4">
<h4 id="historical">historical<a class="anchor" aria-label="anchor" href="#historical"></a>
</h4>
<p>To convert the rasters to binary predictors of presence / absence,
first I will create the classification matrices needed by the
<code><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify()</a></code> function. Before converting, lets check the
range of values.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_1995</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># convert scientific notation to decimals</span></span></code></pre></div>
<pre><code><span><span class="co">##     global_suitability  </span></span>
<span><span class="co">## min "0.0000000001702356"</span></span>
<span><span class="co">## max "1.0000000000000000"</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_1995</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     ensemble_suitability</span></span>
<span><span class="co">## min "0.0000001336334"   </span></span>
<span><span class="co">## max "0.7144208550453"</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all looks good</span></span></code></pre></div>
<p>Now I will create the classification rasters. I will pull these from
their respective .csv files.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create regional suitability value matrix for terra</span></span>
<span><span class="va">regional_ensemble_classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0000000001</span><span class="op">)</span>, <span class="co"># add a small amount to the lower end of the 2nd range</span></span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>  becomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000010</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># the strtoi function converts to base-2, becomes 1 and 2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">global_classes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0000000001</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>  becomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00001000</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># becomes 4 and 8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now I can reclassify the MaxEnt outputs. I will load in the averaged
predictions for the global and regional models for the time period
1981-2010. I will reclassify their values based on the two matrices
above. This chunk might take some time to run.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regional</span></span>
<span><span class="co"># reclassify and write regional raster</span></span>
<span><span class="va">regional_ensemble_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">regional_ensemble_1995</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">regional_ensemble_classes</span>,</span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, <span class="co"># close both ends of the range of classification values</span></span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="co"># make it the unsuitable value if not in this range</span></span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_1981-2010.asc"</span><span class="op">)</span>, <span class="co"># also write to file</span></span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">global_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">global_1995</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">global_classes</span>, </span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_1981-2010.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>I will run a few error checks to ensure that the binarization process
worked.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_1995_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_1995_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">global_1995_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">regional_ensemble_1995_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now that the rasters have been converted to binary, we will visualize
them to ensure that the process worked. Since the same process was done
to both the regional and global models, I will only plot the regional
model.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in binary raster just created and convert to df</span></span>
<span><span class="va">regional_ensemble_1995_classified_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_1981-2010.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span>  <span class="co">#na.omit()</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">regional_ensemble_1995_classified_df</span><span class="op">$</span><span class="va">ensemble_suitability</span><span class="op">)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regional unsuitable"</span>, <span class="st">"regional suitable"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"azure4"</span>,</span>
<span>  <span class="st">"darkblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot regional binary</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">regional_ensemble_1995_classified_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ensemble_suitability</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Binarized suitability for 'regional_ensemble' model"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"suitability for SLF"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre>
<p><img src="120_create_suitability_maps_files/figure-html/plot%20binarized%20raster-%20hist-1.png" width="700"></p>
<p>I will perform the same operation as above for the predicted climate
change rasters from 2041-2070 (ssp126, 370, 585 and the mean of
these).</p>
<p>The helper function below, <code>classify_matrix()</code>, will
create the object needed to classify each raster into the binary-based
classes I outlined above.</p>
</div>
<div class="section level4">
<h4 id="helper-function--terra-classify">helper function- terra classify<a class="anchor" aria-label="anchor" href="#helper-function--terra-classify"></a>
</h4>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">classify_matrix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">thresh</span>, <span class="va">model.scale</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># thresh = the threshold for suitability in that model</span></span>
<span>  <span class="co"># model = either of "global" or "regional"</span></span>
<span>  </span>
<span>  <span class="co"># the strtoi function converts a number to base-2</span></span>
<span>  </span>
<span>  <span class="co"># regional model classes</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">model.scale</span> <span class="op">==</span> <span class="st">"regional"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0000000001</span><span class="op">)</span>, <span class="co"># add a small amount to the lower end of the 2nd range</span></span>
<span>      to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      becomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000010</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># becomes 1 and 2</span></span>
<span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># otherwise, go with global model</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">model.scale</span> <span class="op">==</span> <span class="st">"global"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0000000001</span><span class="op">)</span>,</span>
<span>      to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">thresh</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>      becomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00001000</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># becomes 4 and 8</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp-126-1">ssp 126<a class="anchor" aria-label="anchor" href="#ssp-126-1"></a>
</h4>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_126</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># convert scientific notation to decimals</span></span>
<span></span>
<span></span>
<span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_126</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="va">global_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"global"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># regional ensemble</span></span>
<span><span class="va">regional_ensemble_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">7</span>, <span class="fl">4</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"regional"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regional</span></span>
<span><span class="co"># reclassify and write regional raster</span></span>
<span><span class="va">regional_ensemble_2055_126_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">regional_ensemble_2055_126</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">regional_ensemble_classes</span>,</span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, <span class="co"># close both ends of the range of classification values</span></span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="co"># make it the unsuitable value if not in this range</span></span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span>, <span class="co"># also write to file</span></span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">global_2055_126_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">global_2055_126</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">global_classes</span>, </span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_126_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_126_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">global_2055_126_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_126_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in binary raster just created and convert to df</span></span>
<span><span class="va">regional_ensemble_2055_126_classified_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_126_classified_df</span><span class="op">$</span><span class="va">ensemble_suitability</span><span class="op">)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regional unsuitable"</span>, <span class="st">"regional suitable"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"azure4"</span>,</span>
<span>  <span class="st">"darkblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot regional binary</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">regional_ensemble_2055_126_classified_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ensemble_suitability</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Binarized suitability for 'regional_ensemble' model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"projected to 2041-2070 | ssp126 | GFDL"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"suitability for SLF"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp-370-1">ssp 370<a class="anchor" aria-label="anchor" href="#ssp-370-1"></a>
</h4>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_370</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># convert scientific notation to decimals</span></span>
<span></span>
<span></span>
<span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_370</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="va">global_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"global"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># regional ensemble</span></span>
<span><span class="va">regional_ensemble_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">8</span>, <span class="fl">4</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"regional"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regional</span></span>
<span><span class="co"># reclassify and write regional raster</span></span>
<span><span class="va">regional_ensemble_2055_370_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">regional_ensemble_2055_370</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">regional_ensemble_classes</span>,</span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, <span class="co"># close both ends of the range of classification values</span></span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="co"># make it the unsuitable value if not in this range</span></span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span>, <span class="co"># also write to file</span></span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">global_2055_370_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">global_2055_370</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">global_classes</span>, </span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_370_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_370_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">global_2055_370_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_370_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in binary raster just created and convert to df</span></span>
<span><span class="va">regional_ensemble_2055_370_classified_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_370_classified_df</span><span class="op">$</span><span class="va">ensemble_suitability</span><span class="op">)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regional unsuitable"</span>, <span class="st">"regional suitable"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"azure4"</span>,</span>
<span>  <span class="st">"darkblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot regional binary</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">regional_ensemble_2055_370_classified_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ensemble_suitability</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Binarized suitability for 'regional_ensemble' model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"projected to 2041-2070 | ssp370 | GFDL"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"suitability for SLF"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp-585-1">ssp 585<a class="anchor" aria-label="anchor" href="#ssp-585-1"></a>
</h4>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_585</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># convert scientific notation to decimals</span></span>
<span></span>
<span></span>
<span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_585</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="va">global_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"global"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># regional ensemble</span></span>
<span><span class="va">regional_ensemble_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">9</span>, <span class="fl">4</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"regional"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regional</span></span>
<span><span class="co"># reclassify and write regional raster</span></span>
<span><span class="va">regional_ensemble_2055_585_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">regional_ensemble_2055_585</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">regional_ensemble_classes</span>,</span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, <span class="co"># close both ends of the range of classification values</span></span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="co"># make it the unsuitable value if not in this range</span></span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span>, <span class="co"># also write to file</span></span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">global_2055_585_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">global_2055_585</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">global_classes</span>, </span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_585_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_585_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">global_2055_585_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_585_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in binary raster just created and convert to df</span></span>
<span><span class="va">regional_ensemble_2055_585_classified_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_585_classified_df</span><span class="op">$</span><span class="va">ensemble_suitability</span><span class="op">)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regional unsuitable"</span>, <span class="st">"regional suitable"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"azure4"</span>,</span>
<span>  <span class="st">"darkblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot regional binary</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">regional_ensemble_2055_585_classified_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ensemble_suitability</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Binarized suitability for 'regional_ensemble' model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"projected to 2041-2070 | ssp585 | GFDL"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"suitability for SLF"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ssp-mean-1">ssp mean<a class="anchor" aria-label="anchor" href="#ssp-mean-1"></a>
</h4>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_ssp_mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># convert scientific notation to decimals</span></span></code></pre></div>
<pre><code><span><span class="co">##     global_suitability   </span></span>
<span><span class="co">## min "0.00000000003642224"</span></span>
<span><span class="co">## max "1.00000000000000000"</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the range of the values in the raster</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_ssp_mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     ensemble_suitability</span></span>
<span><span class="co">## min "0.0000001578022"   </span></span>
<span><span class="co">## max "0.7055209279060"</span></span></code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="va">global_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">summary_global</span><span class="op">[</span><span class="fl">42</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"global"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># regional ensemble</span></span>
<span><span class="va">regional_ensemble_classes</span> <span class="op">&lt;-</span> <span class="fu">classify_matrix</span><span class="op">(</span></span>
<span>  thresh <span class="op">=</span> <span class="va">regional_ensemble_thresholds</span><span class="op">[</span><span class="fl">10</span>, <span class="fl">4</span><span class="op">]</span>,</span>
<span>  model.scale <span class="op">=</span> <span class="st">"regional"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regional</span></span>
<span><span class="co"># reclassify and write regional raster</span></span>
<span><span class="va">regional_ensemble_2055_ssp_mean_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">regional_ensemble_2055_ssp_mean</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">regional_ensemble_classes</span>,</span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, <span class="co"># close both ends of the range of classification values</span></span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="co"># make it the unsuitable value if not in this range</span></span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span>, <span class="co"># also write to file</span></span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span>
<span></span>
<span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">global_2055_ssp_mean_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">global_2055_ssp_mean</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">global_classes</span>, </span>
<span>  right <span class="op">=</span> <span class="cn">NA</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">global_2055_ssp_mean_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_ssp_mean_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">global_2055_ssp_mean_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_ssp_mean_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now lets plot the binarized mean of the ssp scenarios.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in binary raster just created and convert to df</span></span>
<span><span class="va">regional_ensemble_2055_ssp_mean_classified_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">regional_ensemble_2055_ssp_mean_classified_df</span><span class="op">$</span><span class="va">ensemble_suitability</span><span class="op">)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regional unsuitable"</span>, <span class="st">"regional suitable"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"azure4"</span>,</span>
<span>  <span class="st">"darkblue"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot regional binary</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">regional_ensemble_2055_ssp_mean_classified_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">ensemble_suitability</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Binarized suitability for 'regional_ensemble' model"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"projected to 2041-2070 | mean of ssp126, 370, 585 | GFDL"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"suitability for SLF"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre>
<p><img src="120_create_suitability_maps_files/figure-html/plot%20binarized%20raster-%20ssp%20mean-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="mosaic-rasters-and-produce-map">2.2 Mosaic rasters and produce map<a class="anchor" aria-label="anchor" href="#mosaic-rasters-and-produce-map"></a>
</h3>
<p>From the plots, we see that the binary conversion worked. Next, I
will need to stack the reclassified global and regional rasters and add
them into a single raster output. This should give me a final raster
with 4 classes:</p>
<table class="table">
<thead><tr class="header">
<th>SLF suitability</th>
<th>raster value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Unsuitable Agreement</td>
<td>5</td>
</tr>
<tr class="even">
<td>Suitable Agreement</td>
<td>10</td>
</tr>
<tr class="odd">
<td>unsuitable regional/suitable global</td>
<td>9</td>
</tr>
<tr class="even">
<td>Suitable regional/unsuitable global</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>The mosaic function combines spatRasters that overlap in extent into
a new raster, via the function specified (addition, in this case). I
will run through this workflow for the historical rasters, then will
functionalize the plotting for the ssp scenarios.</p>
<div class="section level4">
<h4 id="historical-1">historical<a class="anchor" aria-label="anchor" href="#historical-1"></a>
</h4>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regional_ensemble_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_binarized_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">global_1995_classified</span>, <span class="va">regional_ensemble_1995_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_1981-2010.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>progress <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># progress bar</span></span></code></pre></div>
<p>I will prepare plotting objects.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># rename values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_regional_binarized"</span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_1995_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_binarized_1995_df</span><span class="op">$</span><span class="va">global_regional_binarized</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  5  6 10  9</span></span></code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># i manually ordered these</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>, <span class="st">"extreme"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"azure4"</span>, <span class="st">"gold"</span>, <span class="st">"darkorange"</span>, <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">slf_binarized_1995_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">global_regional_binarized</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected risk of Lycorma delicatula invasion globally"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"1981-2010"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"projected risk"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_coloursteps.html" class="external-link">guide_colorsteps</a></span><span class="op">(</span>frame.colour <span class="op">=</span> <span class="st">"black"</span>, ticks.colour <span class="op">=</span> <span class="st">"black"</span>, barwidth <span class="op">=</span> <span class="fl">20</span>, draw.ulim <span class="op">=</span> <span class="cn">TRUE</span>, draw.llim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_1995_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_1981-2010.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="helper-function--binary-raster-plotting">helper function- binary raster plotting<a class="anchor" aria-label="anchor" href="#helper-function--binary-raster-plotting"></a>
</h4>
<p>Now that I have run through the process once, I will functionalize
the plotting process for the ssp scenarios to save time and lines of
code.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># i manually ordered these</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"moderate"</span>, <span class="st">"high"</span>, <span class="st">"extreme"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"azure4"</span>, <span class="st">"gold"</span>, <span class="st">"darkorange"</span>, <span class="st">"darkred"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># function</span></span>
<span><span class="va">plot_binary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">raster.df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># raster.df = data frame of the raster to be plotted</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># default map style</span></span>
<span>    <span class="va">map_style_binarized</span> <span class="op">+</span></span>
<span>    <span class="co"># raster layer</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raster.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">global_regional_binarized</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># custom discrete scale</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"projected risk"</span>,</span>
<span>      <span class="co"># use objects outlined above</span></span>
<span>      values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>      breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>      labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>      aesthetics <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>      guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_coloursteps.html" class="external-link">guide_colorsteps</a></span><span class="op">(</span>frame.colour <span class="op">=</span> <span class="st">"black"</span>, ticks.colour <span class="op">=</span> <span class="st">"black"</span>, barwidth <span class="op">=</span> <span class="fl">20</span>, draw.ulim <span class="op">=</span> <span class="cn">TRUE</span>, draw.llim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># other theme customizations</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp126">ssp126<a class="anchor" aria-label="anchor" href="#ssp126"></a>
</h4>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_2055_126_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_126_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_binarized_2055_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_126_classified</span>, <span class="va">regional_ensemble_2055_126_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>, <span class="co"># progress bar</span></span>
<span>    names <span class="op">=</span> <span class="st">"global_regional_binarized"</span> <span class="co"># layer name, change in function if this changes</span></span>
<span>    <span class="op">)</span>  </span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_126_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126_df</span><span class="op">$</span><span class="va">global_regional_binarized</span><span class="op">)</span></span>
<span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_126_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_binary</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_binarized_2055_126_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected risk of Lycorma delicatula invasion globally under climate change"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp126 GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_2055_126_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp126_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp370">ssp370<a class="anchor" aria-label="anchor" href="#ssp370"></a>
</h4>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_2055_370_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_370_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_binarized_2055_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_370_classified</span>, <span class="va">regional_ensemble_2055_370_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>, <span class="co"># progress bar</span></span>
<span>    names <span class="op">=</span> <span class="st">"global_regional_binarized"</span> <span class="co"># layer name, change in function if this changes</span></span>
<span>    <span class="op">)</span>  </span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_370_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370_df</span><span class="op">$</span><span class="va">global_regional_binarized</span><span class="op">)</span></span>
<span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_370_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_binary</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_binarized_2055_370_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected risk of Lycorma delicatula invasion globally under climate change"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp370 GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_2055_370_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp370_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 class="hidden" id="ssp585">ssp585<a class="anchor" aria-label="anchor" href="#ssp585"></a>
</h4>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_2055_585_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_585_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_binarized_2055_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_585_classified</span>, <span class="va">regional_ensemble_2055_585_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>, <span class="co"># progress bar</span></span>
<span>    names <span class="op">=</span> <span class="st">"global_regional_binarized"</span> <span class="co"># layer name, change in function if this changes</span></span>
<span>    <span class="op">)</span>  </span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_585_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585_df</span><span class="op">$</span><span class="va">global_regional_binarized</span><span class="op">)</span></span>
<span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_585_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_binary</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_binarized_2055_585_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected risk of Lycorma delicatula invasion globally under climate change"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp585 GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_2055_585_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp585_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ssp-mean-2">ssp mean<a class="anchor" aria-label="anchor" href="#ssp-mean-2"></a>
</h4>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_2055_ssp_mean_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_global_v3_binarized_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">regional_ensemble_2055_ssp_mean_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_regional_ensemble_v1_binarized_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_binarized_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">global_2055_ssp_mean_classified</span>, <span class="va">regional_ensemble_2055_ssp_mean_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>, <span class="co"># progress bar</span></span>
<span>    names <span class="op">=</span> <span class="st">"global_regional_binarized"</span> <span class="co"># layer name, change in function if this changes</span></span>
<span>    <span class="op">)</span>  </span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_ssp_mean_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean_df</span><span class="op">$</span><span class="va">global_regional_binarized</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  5  6 10  9</span></span></code></pre>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_ssp_mean_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_binary</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_binarized_2055_ssp_mean_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected risk of Lycorma delicatula invasion globally under climate change"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | mean of ssp126, ssp370 and ssp585, GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_2055_ssp_mean_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp_mean_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="calculate-total-area-predicted-by-each-model">3. Calculate total area predicted by each model<a class="anchor" aria-label="anchor" href="#calculate-total-area-predicted-by-each-model"></a>
</h2>
<p>The figures above are classified into categories of low, moderate,
high and extreme risk for SLF establishment. In addition to visualizing
them, I want to know the total predicted area in each category.</p>
<p>I will calculate the total suitable area predicted by each category
and model.</p>
<p>As a reminder, the categories in these rasters are:</p>
<table class="table">
<thead><tr class="header">
<th>SLF suitability</th>
<th>raster value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Unsuitable Agreement</td>
<td>5</td>
</tr>
<tr class="even">
<td>Suitable Agreement</td>
<td>10</td>
</tr>
<tr class="odd">
<td>unsuitable regional/suitable global</td>
<td>9</td>
</tr>
<tr class="even">
<td>Suitable regional/unsuitable global</td>
<td>6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load rasters</span></span>
<span><span class="va">slf_binarized_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">slf_binarized_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># 1995</span></span>
<span><span class="va">slf_model_prop_table_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_1995</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"km"</span>,</span>
<span>  byValue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># 2055</span></span>
<span><span class="va">slf_model_prop_table_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_2055_ssp_mean</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"km"</span>,</span>
<span>  byValue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create list of range shift values</span></span>
<span><span class="va">categories.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  model_suitability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unsuitable_agreement"</span>, <span class="st">"regional"</span>, <span class="st">"global"</span>, <span class="st">"suitable_agreement"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># join</span></span>
<span><span class="va">slf_model_prop_table_joined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">slf_model_prop_table_1995</span>, <span class="va">slf_model_prop_table_2055_ssp_mean</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"value"</span>, <span class="st">"layer"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># add labels</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">categories.obj</span>, by <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tidy</span></span>
<span><span class="va">slf_model_prop_table_joined</span> <span class="op">&lt;-</span> <span class="va">slf_model_prop_table_joined</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">layer</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    <span class="st">"area_km_1995"</span> <span class="op">=</span> <span class="st">"area.x"</span>,</span>
<span>    <span class="st">"area_km_2055"</span> <span class="op">=</span> <span class="st">"area.y"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># make proportions</span></span>
<span>    prop_total_area_1995 <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">area_km_1995</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">area_km_1995</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    prop_total_area_2055 <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">area_km_2055</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">area_km_2055</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># change labels</span></span>
<span>    area_km_1995 <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">area_km_1995</span><span class="op">)</span>,</span>
<span>    area_km_2055 <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">area_km_2055</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">model_suitability</span>, <span class="va">area_km_1995</span>, <span class="va">prop_total_area_1995</span>, <span class="va">area_km_2055</span>, <span class="va">prop_total_area_2055</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>   <span class="st">"prop_area_present"</span> <span class="op">=</span> <span class="st">"prop_total_area_1995"</span>,</span>
<span>   <span class="st">"prop_area_2041-2070"</span> <span class="op">=</span> <span class="st">"prop_total_area_2055"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># add superscript</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"area_km"</span>, <span class="fu">common</span><span class="fu">::</span><span class="fu"><a href="https://common.r-sassy.org/reference/supsc.html" class="external-link">supsc</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span>, <span class="st">"_present"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"area_km"</span>, <span class="fu">common</span><span class="fu">::</span><span class="fu"><a href="https://common.r-sassy.org/reference/supsc.html" class="external-link">supsc</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span>, <span class="st">"_2041-2070"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># .html formatting</span></span>
<span><span class="co"># format row colors</span></span>
<span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"azure4"</span><span class="op">)</span></span>
<span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span></span>
<span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"gold"</span><span class="op">)</span></span>
<span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to kable</span></span>
<span><span class="va">slf_model_prop_kable</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">slf_model_prop_table_joined</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">slf_model_prop_kable</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;table class="table table-striped" style="margin-left: auto; margin-right: auto;"&gt;</span></span>
<span><span class="co">##  &lt;thead&gt;</span></span>
<span><span class="co">##   &lt;tr&gt;</span></span>
<span><span class="co">##    &lt;th style="text-align:left;"&gt; model_suitability &lt;/th&gt;</span></span>
<span><span class="co">##    &lt;th style="text-align:left;"&gt; area_km²_present &lt;/th&gt;</span></span>
<span><span class="co">##    &lt;th style="text-align:left;"&gt; prop_area_present &lt;/th&gt;</span></span>
<span><span class="co">##    &lt;th style="text-align:left;"&gt; area_km²_2041-2070 &lt;/th&gt;</span></span>
<span><span class="co">##    &lt;th style="text-align:left;"&gt; prop_area_2041-2070 &lt;/th&gt;</span></span>
<span><span class="co">##   &lt;/tr&gt;</span></span>
<span><span class="co">##  &lt;/thead&gt;</span></span>
<span><span class="co">## &lt;tbody&gt;</span></span>
<span><span class="co">##   &lt;tr&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; &lt;span style=" font-weight: bold;    color: rgba(131, 139, 139, 255) !important;"&gt;unsuitable_agreement&lt;/span&gt; &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 118,348,996 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 85.86% &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 117,048,301 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 84.9% &lt;/td&gt;</span></span>
<span><span class="co">##   &lt;/tr&gt;</span></span>
<span><span class="co">##   &lt;tr&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; &lt;span style=" font-weight: bold;    color: darkorange !important;"&gt;regional&lt;/span&gt; &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 9,364,463 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 6.79% &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 11,062,245 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 8.0% &lt;/td&gt;</span></span>
<span><span class="co">##   &lt;/tr&gt;</span></span>
<span><span class="co">##   &lt;tr&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; &lt;span style=" font-weight: bold;    color: gold !important;"&gt;global&lt;/span&gt; &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 1,132,243 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 0.82% &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 1,244,449 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 0.9% &lt;/td&gt;</span></span>
<span><span class="co">##   &lt;/tr&gt;</span></span>
<span><span class="co">##   &lt;tr&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; &lt;span style=" font-weight: bold;    color: darkred !important;"&gt;suitable_agreement&lt;/span&gt; &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 9,000,778 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 6.53% &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 8,491,485 &lt;/td&gt;</span></span>
<span><span class="co">##    &lt;td style="text-align:left;"&gt; 6.2% &lt;/td&gt;</span></span>
<span><span class="co">##   &lt;/tr&gt;</span></span>
<span><span class="co">## &lt;/tbody&gt;</span></span>
<span><span class="co">## &lt;/table&gt;</span></span></code></pre>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model training dataset</span></span>
<span><span class="co"># save as .csv</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">slf_model_prop_table_joined</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_binarized_summed_areas_table.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save as .html</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/save_kable.html" class="external-link">save_kable</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_model_prop_kable</span>, </span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_areas_table.html"</span><span class="op">)</span>,</span>
<span>  self_contained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bs_theme <span class="op">=</span> <span class="st">"simplex"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize webshot by </span></span>
<span><span class="co"># webshot::install_phantomjs()</span></span>
<span><span class="co"># convert to jpg</span></span>
<span><span class="fu">webshot</span><span class="fu">::</span><span class="fu"><a href="http://wch.github.io/webshot/reference/webshot.html" class="external-link">webshot</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_areas_table.html"</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_areas_table.jpg"</span><span class="op">)</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove html</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_areas_table.html"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="map-range-shifting-areas">4. Map range shifting areas<a class="anchor" aria-label="anchor" href="#map-range-shifting-areas"></a>
</h2>
<p>Lastly, I want to create a map of areas where SLF range is expanding,
contracting or remaining the same over time. I will binarize the rasters
so that any point that is above the MTSS threshold on either model
becomes one number and anything above the threshold becomes another.
This will follow a slightly altered version of the methodology from step
2.</p>
<p>I will classify the cells as the following:</p>
<table class="table">
<thead><tr class="header">
<th>Raster and suitability</th>
<th>cloglog range</th>
<th>binary value</th>
<th>output value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Historical unsuitable</td>
<td>5</td>
<td>00000001</td>
<td>1</td>
</tr>
<tr class="even">
<td>Historical suitable</td>
<td>6, 9 or 10</td>
<td>00000010</td>
<td>2</td>
</tr>
<tr class="odd">
<td>2041-2070 unsuitable</td>
<td>5</td>
<td>00000100</td>
<td>4</td>
</tr>
<tr class="even">
<td>2041-2070 suitable</td>
<td>6, 9 or 10</td>
<td>00001000</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>By encoding the rasters into base-2, I have created only 4 possible
values of the raster layers, which can be translated into 4 categories.
I will also interpret these categories in terms of risk of SLF range
expansion::</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="10%">
<col width="10%">
<col width="49%">
</colgroup>
<thead><tr class="header">
<th>Suitability agreement</th>
<th>summed value</th>
<th>binary value</th>
<th>interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Unsuitable Agreement</td>
<td>5</td>
<td>00000101</td>
<td>will stay unsuitable (no range shift)</td>
</tr>
<tr class="even">
<td>Suitable Agreement</td>
<td>10</td>
<td>00001010</td>
<td>will stay suitable (no range shift)</td>
</tr>
<tr class="odd">
<td>unsuitable hist/suitable 2041-2070</td>
<td>9</td>
<td>00001001</td>
<td>will become SUITABLE in the future (range expansion)</td>
</tr>
<tr class="even">
<td>Suitable hist/unsuitable 2041-2070</td>
<td>6</td>
<td>00000110</td>
<td>will become UNSUITABLE in the future (range contraction)</td>
</tr>
</tbody>
</table>
<p>I will classify areas of unsuitability as gray, per usual. Areas
where SLF remains the same will be white, areas where SLF is expanding
will be green, and areas where SLF is contracting will be red.</p>
<p>First, I will load in the historical binarized raster (the
intersection between the regional and global models) and classify it in
preparation for this analysis. Then, I will intersect this raster with
each of the predicted ssp rasters and the mean of those scenarios.</p>
<div class="section level3">
<h3 id="setup-1">4.1 Setup<a class="anchor" aria-label="anchor" href="#setup-1"></a>
</h3>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1995</span></span>
<span><span class="va">slf_binarized_1995</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># rename values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_regional_binarized_1995"</span></span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_1995_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p>I will also load some classification matrices for
<code><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">terra::classify()</a></code>. These should not change between maps
because we are classifying based on the time period, which does not
change.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create historical suitability value matrix for terra</span></span>
<span><span class="va">classes_1995</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  becomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000010</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000010</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000010</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="co"># the strtoi function converts to base-2, becomes 1 and 2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the class for all CMIP6 scenarios</span></span>
<span><span class="va">classes_2055</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  is <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  becomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00001000</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00001000</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00001000</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="co"># becomes 4 and 8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>I will go ahead and classify the historical binarized raster because
I will use it in the next steps</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reclassify and write the historical binarized raster</span></span>
<span><span class="va">slf_binarized_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_1995</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">classes_1995</span>,</span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000001</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_1981-2010.asc"</span><span class="op">)</span>, <span class="co"># also write to file</span></span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>I will quickly ensure that the binarization process worked by
creating a rough plot.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load in binary raster just created and convert to df</span></span>
<span><span class="va">slf_binarized_1995_classified_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_1981-2010.asc"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">.</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span>  <span class="co">#na.omit()</span></span>
<span></span>
<span><span class="co"># now, create vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified_df</span><span class="op">$</span><span class="va">global_regional_binarized_1995</span><span class="op">)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"present unsuitable"</span>, <span class="st">"present suitable"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"azure4"</span>,</span>
<span>  <span class="st">"azure"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot regional binary</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">slf_binarized_1995_classified_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">global_regional_binarized_1995</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"current suitability for SLF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"suitability for SLF"</span>,</span>
<span>    values <span class="op">=</span> <span class="va">values.obj</span>,</span>
<span>    breaks <span class="op">=</span> <span class="va">breaks.obj</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">labels.obj</span>,</span>
<span>    aesthetics <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="va">map_style_binarized</span></span></code></pre></div>
<p>The conversion worked, as anything colorful on the binarized map
should now be white. I will load a helper function for future plotting,
similar to the one in step 2.2. I will interpret these categories in
terms range shifts, as discussed above:</p>
<ul>
<li>Unsuitable Agreement = 5 -&gt; area will stay unsuitable (no range
shift)</li>
<li>Suitable Agreement = 10 -&gt; area will stay suitable (no range
shift)</li>
<li>unsuitable 1995/suitable 2055 = 9 -&gt; area will become SUITABLE in
the future (range expansion)</li>
<li>Suitable 1995/unsuitable 2055 = 6 -&gt; area will become UNSUITABLE
in the future (range contraction)</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vectors of values used to manually edit the scale of the plot</span></span>
<span><span class="co"># the possible values of the scale and their order</span></span>
<span><span class="va">breaks.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">6</span>, <span class="fl">9</span><span class="op">)</span> <span class="co"># i manually ordered these according to the order produced from unique(slf_range_shift_126_df$range_shift_summed)</span></span>
<span><span class="co"># labels for the values</span></span>
<span><span class="va">labels.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unsuitable area\nretained"</span>, <span class="st">"suitabile area\nretained"</span>, <span class="st">"contraction\nsuitable area"</span>, <span class="st">"expansion\nsuitable area"</span><span class="op">)</span></span>
<span><span class="co"># vector of colors to classify scale</span></span>
<span><span class="va">values.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"azure4"</span>, <span class="st">"azure"</span>, <span class="st">"darkred"</span>, <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># function</span></span>
<span><span class="va">plot_range_shift</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">raster.df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># raster.df = the df of the raster to be plotted</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># default style</span></span>
<span>    <span class="va">map_style_binarized</span> <span class="op">+</span></span>
<span>    <span class="co"># plot raster</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">raster.df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">range_shift_summed</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># discretized scale </span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_discrete_manual</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"L delicatula\nsuitability shift"</span>,</span>
<span>      values <span class="op">=</span> <span class="va">values.obj</span>, <span class="co"># the colors</span></span>
<span>      breaks <span class="op">=</span> <span class="va">breaks.obj</span>, <span class="co"># the breaks in the colors (4 since this is a discrete scale)</span></span>
<span>      labels <span class="op">=</span> <span class="va">labels.obj</span>, <span class="co"># the labels per color bin</span></span>
<span>      aesthetics <span class="op">=</span> <span class="st">"fill"</span>,</span>
<span>      guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_coloursteps.html" class="external-link">guide_colorsteps</a></span><span class="op">(</span>frame.colour <span class="op">=</span> <span class="st">"black"</span>, ticks.colour <span class="op">=</span> <span class="st">"black"</span>, barwidth <span class="op">=</span> <span class="fl">20</span>, draw.ulim <span class="op">=</span> <span class="cn">TRUE</span>, draw.llim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># aesthetics</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>I will create another helper function to format a range shift table
per ssp scenario, which I will create later.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create list of range shift values</span></span>
<span><span class="va">ranges.obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"remains_unsuitable"</span>, <span class="st">"contraction"</span>, <span class="st">"expansion"</span>, <span class="st">"retained_suitability"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table_range_shift</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table.df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># table.df = dataframe of areas for raster bins, created by terra::expanse</span></span>
<span></span>
<span>  <span class="co"># tidy</span></span>
<span>  <span class="va">table.df.output</span> <span class="op">&lt;-</span> <span class="va">table.df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">layer</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      Ld_range_shift_type <span class="op">=</span> <span class="va">ranges.obj</span>,</span>
<span>      prop_total_area <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_percent.html" class="external-link">label_percent</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">area</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      area <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_comma</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="va">area</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">Ld_range_shift_type</span>, <span class="va">area</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">table.df.output</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"area_km"</span>, <span class="fu">common</span><span class="fu">::</span><span class="fu"><a href="https://common.r-sassy.org/reference/supsc.html" class="external-link">supsc</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># .html formatting</span></span>
<span><span class="co"># format row colors</span></span>
<span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, background <span class="op">=</span> <span class="st">"azure4"</span><span class="op">)</span></span>
<span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, background <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span>
<span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, background <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/cell_spec.html" class="external-link">cell_spec</a></span><span class="op">(</span><span class="va">table.df.output</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">]</span>, format <span class="op">=</span> <span class="st">"html"</span>, background <span class="op">=</span> <span class="st">"azure"</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="co"># return</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">table.df.output</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ssp-126-2">4.2 ssp 126<a class="anchor" aria-label="anchor" href="#ssp-126-2"></a>
</h3>
<div class="section level4">
<h4 id="classify">classify<a class="anchor" aria-label="anchor" href="#classify"></a>
</h4>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># rename values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_regional_binarized_2055_126"</span></span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_126_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all looks good</span></span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write binarized raster</span></span>
<span><span class="va">slf_binarized_2055_126_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_2055_126</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">classes_2055</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>I will run a few error checks to ensure that the binarization process
worked.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_126_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="mosaic">Mosaic<a class="anchor" aria-label="anchor" href="#mosaic"></a>
</h4>
<p>Next, I will need to stack the reclassified 1995 and 2055 rasters and
add them into a single raster output. This should give me the a raster
with 4 classes:</p>
<ul>
<li>Unsuitable Agreement = 5</li>
<li>Suitable Agreement = 10</li>
<li>unsuitable 1995/suitable 2055 = 9</li>
<li>Suitable 1995/unsuitable 2055 = 6</li>
</ul>
<p>The mosaic function combines spatRasters that overlap in extent into
a new raster, via the function specified (addition, in this case).</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slf_binarized_2055_126_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp126_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_range_shift_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_1995_classified</span>, <span class="va">slf_binarized_2055_126_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp126_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    names <span class="op">=</span> <span class="st">"range_shift_summed"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="co"># progress bar</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h4>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># re-load created raster</span></span>
<span><span class="va">slf_range_shift_126</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp126_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_range_shift_126_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_range_shift_126</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_range_shift_126_df</span><span class="op">$</span><span class="va">range_shift_summed</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  5  9 10  6</span></span></code></pre>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_126_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_range_shift</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_range_shift_126_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected areas suitable for Lycorma delicatula range expansion"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp126 GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_126_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_ssp126_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sum-areas-gained-and-lost">sum areas gained and lost<a class="anchor" aria-label="anchor" href="#sum-areas-gained-and-lost"></a>
</h4>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_126_table</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_range_shift_126</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"km"</span>,</span>
<span>  byValue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_126_table</span> <span class="op">&lt;-</span> <span class="fu">table_range_shift</span><span class="op">(</span>table.df <span class="op">=</span> <span class="va">slf_range_shift_126_table</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save as .csv</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">slf_range_shift_126_table</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp126_GFDL.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to kable</span></span>
<span><span class="va">slf_range_shift_126_kable</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">slf_range_shift_126_table</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save as .html</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/save_kable.html" class="external-link">save_kable</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_126_kable</span>, </span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp126_GFDL.html"</span><span class="op">)</span>,</span>
<span>  self_contained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bs_theme <span class="op">=</span> <span class="st">"simplex"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize webshot by </span></span>
<span><span class="co"># webshot::install_phantomjs()</span></span>
<span><span class="co"># convert to pdf</span></span>
<span><span class="fu">webshot</span><span class="fu">::</span><span class="fu"><a href="http://wch.github.io/webshot/reference/webshot.html" class="external-link">webshot</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp126_GFDL.html"</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp126_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove .html</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp126_GFDL.html"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now, I will repeat this process for the other SSP scenarios and the
mean of those scenarios (code not shown).</p>
</div>
</div>
<div class="section level3">
<h3 class="hidden" id="ssp-370-2">4.3 ssp 370<a class="anchor" aria-label="anchor" href="#ssp-370-2"></a>
</h3>
<p>classify</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># rename values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_regional_binarized_2055_370"</span></span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_370_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all looks good</span></span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">slf_binarized_2055_370_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_2055_370</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">classes_2055</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>I will run a few error checks to ensure that the binarization process
worked.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_370_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Mosaic</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slf_binarized_2055_370_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp370_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_range_shift_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_1995_classified</span>, <span class="va">slf_binarized_2055_370_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp370_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    names <span class="op">=</span> <span class="st">"range_shift_summed"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="co"># progress bar</span></span></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># re-load created raster</span></span>
<span><span class="va">slf_range_shift_370</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp370_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_range_shift_370_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_range_shift_370</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_range_shift_370_df</span><span class="op">$</span><span class="va">range_shift_summed</span><span class="op">)</span></span>
<span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_370_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_range_shift</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_range_shift_370_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected areas suitable for Lycorma delicatula range expansion"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp370 GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_370_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_ssp370_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>sum areas gained and lost</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_370_table</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_range_shift_370</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"km"</span>,</span>
<span>  byValue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_370_table</span> <span class="op">&lt;-</span> <span class="fu">table_range_shift</span><span class="op">(</span>table.df <span class="op">=</span> <span class="va">slf_range_shift_370_table</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save as .csv</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">slf_range_shift_370_table</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp370_GFDL.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to kable</span></span>
<span><span class="va">slf_range_shift_370_kable</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">slf_range_shift_370_table</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save as .html</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/save_kable.html" class="external-link">save_kable</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_370_kable</span>, </span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp370_GFDL.html"</span><span class="op">)</span>,</span>
<span>  self_contained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bs_theme <span class="op">=</span> <span class="st">"simplex"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize webshot by </span></span>
<span><span class="co"># webshot::install_phantomjs()</span></span>
<span><span class="co"># convert to pdf</span></span>
<span><span class="fu">webshot</span><span class="fu">::</span><span class="fu"><a href="http://wch.github.io/webshot/reference/webshot.html" class="external-link">webshot</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp370_GFDL.html"</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp370_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove .html</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp370_GFDL.html"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="hidden" id="ssp-585-2">4.4 ssp 585<a class="anchor" aria-label="anchor" href="#ssp-585-2"></a>
</h3>
<p>classify</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># rename values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_regional_binarized_2055_585"</span></span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_585_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all looks good</span></span></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">slf_binarized_2055_585_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_2055_585</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">classes_2055</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>I will run a few error checks to ensure that the binarization process
worked.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_585_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Mosaic</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slf_binarized_2055_585_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp585_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_range_shift_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_1995_classified</span>, <span class="va">slf_binarized_2055_585_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp585_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    names <span class="op">=</span> <span class="st">"range_shift_summed"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="co"># progress bar</span></span></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># re-load created raster</span></span>
<span><span class="va">slf_range_shift_585</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp585_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_range_shift_585_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_range_shift_585</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_range_shift_585_df</span><span class="op">$</span><span class="va">range_shift_summed</span><span class="op">)</span></span>
<span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_585_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_range_shift</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_range_shift_585_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected areas suitable for Lycorma delicatula range expansion"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | ssp585 GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_585_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_ssp585_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>sum areas gained and lost</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_585_table</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_range_shift_585</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"km"</span>,</span>
<span>  byValue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_585_table</span> <span class="op">&lt;-</span> <span class="fu">table_range_shift</span><span class="op">(</span>table.df <span class="op">=</span> <span class="va">slf_range_shift_585_table</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save as .csv</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">slf_range_shift_585_table</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp585_GFDL.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to kable</span></span>
<span><span class="va">slf_range_shift_585_kable</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">slf_range_shift_585_table</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save as .html</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/save_kable.html" class="external-link">save_kable</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_585_kable</span>, </span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp585_GFDL.html"</span><span class="op">)</span>,</span>
<span>  self_contained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bs_theme <span class="op">=</span> <span class="st">"simplex"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize webshot by </span></span>
<span><span class="co"># webshot::install_phantomjs()</span></span>
<span><span class="co"># convert to pdf</span></span>
<span><span class="fu">webshot</span><span class="fu">::</span><span class="fu"><a href="http://wch.github.io/webshot/reference/webshot.html" class="external-link">webshot</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp585_GFDL.html"</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp585_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove .html</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp585_GFDL.html"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ssp-ssp_mean">4.5 ssp ssp_mean<a class="anchor" aria-label="anchor" href="#ssp-ssp_mean"></a>
</h3>
<p>classify</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_2055_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_binarized_summed_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># rename values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"global_regional_binarized_2055_ssp_mean"</span></span>
<span></span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_binarized_2055_ssp_mean_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all looks good</span></span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># global</span></span>
<span><span class="co"># reclassify and write global raster</span></span>
<span><span class="va">slf_binarized_2055_ssp_mean_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_binarized_2055_ssp_mean</span>, </span>
<span>  rcl <span class="op">=</span> <span class="va">classes_2055</span>, </span>
<span>  others <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strtoi.html" class="external-link">strtoi</a></span><span class="op">(</span><span class="fl">00000100</span>, base <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span>, </span>
<span>  filetype <span class="op">=</span> <span class="st">"AAIGrid"</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>I will run a few error checks to ensure that the binarization process
worked.</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># take minmax</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/minmax.html" class="external-link">minmax</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">.</span>, scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># all good</span></span>
<span></span>
<span><span class="co"># check unique values</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_1995_classified</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">slf_binarized_2055_ssp_mean_classified</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Mosaic</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_1981-2010.asc"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">slf_binarized_2055_ssp_mean_classified</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_2041-2070_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overlay and combine rasters by summing values</span></span>
<span><span class="va">slf_range_shift_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mosaic.html" class="external-link">mosaic</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_1995_classified</span>, <span class="va">slf_binarized_2055_ssp_mean_classified</span>, <span class="co"># rasters</span></span>
<span>  fun <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp_mean_GFDL.asc"</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  wopt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    progress <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    names <span class="op">=</span> <span class="st">"range_shift_summed"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="co"># progress bar</span></span></code></pre></div>
<p>Plot</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># re-load created raster</span></span>
<span><span class="va">slf_range_shift_ssp_mean</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mypath</span>, <span class="st">"working_dir"</span>, <span class="st">"slf_range_shift_summed_ssp_mean_GFDL.asc"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># convert to df</span></span>
<span><span class="va">slf_range_shift_ssp_mean_df</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">slf_range_shift_ssp_mean</span>, xy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#%&gt;%</span></span>
<span> <span class="co"># na.omit()</span></span>
<span></span>
<span><span class="co"># check for the number of unique values in the raster values column</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slf_range_shift_ssp_mean_df</span><span class="op">$</span><span class="va">range_shift_summed</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  5  9 10  6</span></span></code></pre>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># it seems that the reclassification worked! Lets map it to be sure.</span></span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_ssp_mean_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_range_shift</span><span class="op">(</span></span>
<span>  raster.df <span class="op">=</span> <span class="va">slf_range_shift_ssp_mean_df</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected areas suitable for Lycorma delicatula range expansion"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"2041-2070 | mean of ssp126, ssp370 and ssp585, GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_ssp_mean_plot</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_ssp_mean_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>sum areas gained and lost</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_ssp_mean_table</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/expanse.html" class="external-link">expanse</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">slf_range_shift_ssp_mean</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"km"</span>,</span>
<span>  byValue <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_range_shift_ssp_mean_table</span> <span class="op">&lt;-</span> <span class="fu">table_range_shift</span><span class="op">(</span>table.df <span class="op">=</span> <span class="va">slf_range_shift_ssp_mean_table</span>, eval <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save as .csv</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">slf_range_shift_ssp_mean_table</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"data-tables"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp_mean_GFDL.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to kable</span></span>
<span><span class="va">slf_range_shift_ssp_mean_kable</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">slf_range_shift_ssp_mean_table</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save as .html</span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/save_kable.html" class="external-link">save_kable</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_range_shift_ssp_mean_kable</span>, </span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp_mean_GFDL.html"</span><span class="op">)</span>,</span>
<span>  self_contained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bs_theme <span class="op">=</span> <span class="st">"simplex"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># initialize webshot by </span></span>
<span><span class="co"># webshot::install_phantomjs()</span></span>
<span><span class="co"># convert to pdf</span></span>
<span><span class="fu">webshot</span><span class="fu">::</span><span class="fu"><a href="http://wch.github.io/webshot/reference/webshot.html" class="external-link">webshot</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp_mean_GFDL.html"</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp_mean_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  zoom <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove .html</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_range_shift_summed_area_table_ssp_mean_GFDL.html"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Gallien, L., Douzet, R., Pratte, S., Zimmermann, N. E., &amp;
Thuiller, W. (2012). Invasive species distribution models – how
violating the equilibrium assumption can create new insights. Global
Ecology and Biogeography, 21(11), 1126–1136. <a href="https://doi.org/10.1111/j.1466-8238.2012.00768.x" class="external-link uri">https://doi.org/10.1111/j.1466-8238.2012.00768.x</a></p></li>
<li><p>Liu, C., White, M., &amp; Newell, G. (2013). Selecting thresholds
for the prediction of species occurrence with presence-only data.
Journal of Biogeography, 40(4), 778–789. <a href="https://doi.org/10.1111/jbi.12058" class="external-link uri">https://doi.org/10.1111/jbi.12058</a></p></li>
<li><p>Liu, C., Newell, G., &amp; White, M. (2016). On the selection of
thresholds for predicting species occurrence with presence-only data.
Ecology and Evolution, 6(1), 337–348. <a href="https://doi.org/10.1002/ece3.1878" class="external-link uri">https://doi.org/10.1002/ece3.1878</a></p></li>
</ol>
</div>
<div class="section level2">
<h2 class="hidden" id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="add-country-admin-boundaries-to-risk-plots">Add country admin boundaries to risk plots<a class="anchor" aria-label="anchor" href="#add-country-admin-boundaries-to-risk-plots"></a>
</h3>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data</span></span>
<span><span class="va">global_countries</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"data-raw"</span>, <span class="st">"ne_countries"</span>, <span class="st">"ne_10m_admin_0_countries.shp"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="section">1995<a class="anchor" aria-label="anchor" href="#section"></a>
</h4>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="va">slf_binarized_1995_plot_withCountries</span> <span class="op">&lt;-</span> <span class="va">slf_binarized_1995_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">global_countries</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># re-crop to usual boundaries</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180.00013888885</span>, <span class="fl">178.999859675084</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">58.5001390148238</span>, <span class="fl">82.99986041915</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_1995_plot_withCountries</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_countries_1981-2010.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="section-1">2055<a class="anchor" aria-label="anchor" href="#section-1"></a>
</h4>
<p>For this analysis, I will only plot the raster of the mean of the 3
ssp scenarios.</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot</span></span>
<span><span class="va">slf_binarized_2055_plot_withCountries</span> <span class="op">&lt;-</span> <span class="va">slf_binarized_2055_ssp_mean_plot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">global_countries</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># re-crop to usual boundaries</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180.00013888885</span>, <span class="fl">178.999859675084</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">58.5001390148238</span>, <span class="fl">82.99986041915</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># save</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_2055_plot_withCountries</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_summed_countries_2041-2070_ssp_mean_GFDL.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="create-patchwork-of-risk-plots">create patchwork of risk plots<a class="anchor" aria-label="anchor" href="#create-patchwork-of-risk-plots"></a>
</h3>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">slf_binarized_1995_plot_withCountries</span> <span class="op">&lt;-</span> <span class="va">slf_binarized_1995_plot_withCountries</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.tag.location <span class="op">=</span> <span class="st">"panel"</span>,</span>
<span>    plot.tag.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    plot.tag <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>tag <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">slf_binarized_2055_plot_withCountries</span> <span class="op">&lt;-</span> <span class="va">slf_binarized_2055_plot_withCountries</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    plot.tag.location <span class="op">=</span> <span class="st">"panel"</span>,</span>
<span>    plot.tag.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    plot.tag <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>tag <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">slf_binarized_patchwork</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">slf_binarized_1995_plot_withCountries</span> <span class="op">/</span> <span class="va">slf_binarized_2055_plot_withCountries</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Projected risk of Lycorma delicatula invasion globally under climate change"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"(A) 1981-2010 (B) 2041-2070 | mean of ssp126, ssp370 and ssp85, GFDL-ESM4"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axes <span class="op">=</span> <span class="st">"collect"</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="co">#plot_layout(widths = unit(20, "cm")) </span></span></code></pre></div>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span></span>
<span>  <span class="va">slf_binarized_patchwork</span>, </span>
<span>  filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"figures"</span>, <span class="st">"slf_binarized_risk_patchwork_ssp_mean.jpg"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">8</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  device <span class="op">=</span> <span class="st">"jpeg"</span>,</span>
<span>  dpi <span class="op">=</span> <span class="st">"retina"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel M. Owens, Matthew R. Helmus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
