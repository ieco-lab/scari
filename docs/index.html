<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>"Research Compendium: Multi-scale modeling of the spotted lanternfly Lycorma delicatula (Hemiptera: Fulgoridae) reveals displaced risk to viticulture and regional range expansion due to climate change" • slfSpread</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="" research compendium: multi-scale modeling of the spotted lanternfly lycorma delicatula fulgoridae reveals displaced risk to viticulture and regional range expansion due climate change>
<meta name="description" content="We outline a workflow for conducting species distribution modeling (SDM) for the risk of establishment of the invasive Lycorma delicatula (spotted lanternfly or SLF) under climate change. We primarily provide tools and resources for viticulturalists to assess and respond to the risk SLF for viticulture at their locality. Viticulturalists should apply our function create_risk_report to create risk maps, range shift maps, risk plots and other outputs at the scale of countries or states/provinces. We also apply a novel multi-scale approach to model this invasive pest that modelers should adapt and apply to model the risk for establishment of other potential global invaders under climate change. We find that our multi-scale approach of ensembling MaxEnt models at the regional-scale provides more refined predictions than our global-scale model and highlights important biological limitations on the spread of SLF.">
<meta property="og:description" content="We outline a workflow for conducting species distribution modeling (SDM) for the risk of establishment of the invasive Lycorma delicatula (spotted lanternfly or SLF) under climate change. We primarily provide tools and resources for viticulturalists to assess and respond to the risk SLF for viticulture at their locality. Viticulturalists should apply our function create_risk_report to create risk maps, range shift maps, risk plots and other outputs at the scale of countries or states/provinces. We also apply a novel multi-scale approach to model this invasive pest that modelers should adapt and apply to model the risk for establishment of other potential global invaders under climate change. We find that our multi-scale approach of ensembling MaxEnt models at the regional-scale provides more refined predictions than our global-scale model and highlights important biological limitations on the spread of SLF.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">slfSpread</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/020_retrieve_SLF_records.html">Retrieve SLF records from various sources and tidy them for MaxEnt modeling</a></li>
    <li><a class="dropdown-item" href="articles/030_retrieve_bioclim_variables.html">Retrieve bioclim rasters from CHELSA and tidy them for MaxEnt modeling</a></li>
    <li><a class="dropdown-item" href="articles/040_setup_global_MaxEnt_model.html">Setup for global-scale MaxEnt model</a></li>
    <li><a class="dropdown-item" href="articles/050_run_global_MaxEnt_model.html">Run global-scale MaxEnt model</a></li>
    <li><a class="dropdown-item" href="articles/051_compute_MaxEnt_summary_statistics_workflow.html">MaxEnt Summary Statistics Output- workflow</a></li>
    <li><a class="dropdown-item" href="articles/060_setup_regional_MaxEnt_models.html">Setup for regional-scale MaxEnt models</a></li>
    <li><a class="dropdown-item" href="articles/070_run_regional_invaded_MaxEnt_model.html">Run 'Ri.NAmerica' model trained on SLF invaded region in North America</a></li>
    <li><a class="dropdown-item" href="articles/080_run_regional_invaded_asian_MaxEnt_model.html">Run 'Ri.Asia' model trained on SLF invaded range in Japan and South Korea</a></li>
    <li><a class="dropdown-item" href="articles/090_run_regional_native_MaxEnt_model.html">Run 'Rn' model trained on SLF native range in east Asia</a></li>
    <li><a class="dropdown-item" href="articles/100_run_ExDet_MIC.html">Run an Extrapolation Detection (NT2) analysis and calculate MIC</a></li>
    <li><a class="dropdown-item" href="articles/110_ensemble_regional_models.html">Ensemble regional-scale models into a single prediction</a></li>
    <li><a class="dropdown-item" href="articles/120_create_suitability_maps.html">Map regional ensemble predictions and intercept with global model</a></li>
    <li><a class="dropdown-item" href="articles/130_create_suitability_xy_plots_viticultural.html">Plot shift in SLF suitability for important viticultural regions under climate change</a></li>
    <li><a class="dropdown-item" href="articles/131_create_suitability_xy_plots_SLF.html">Plot stability of known SLF populations due climate change effects</a></li>
    <li><a class="dropdown-item" href="articles/140_plot_response_curves.html">Plot response curves</a></li>
    <li><a class="dropdown-item" href="articles/141_plot_AUC_var_cont.html">Plot AUC curves and variable contribution graphs</a></li>
    <li><a class="dropdown-item" href="articles/142_calculate_model_fit.html">Calculate model fit statistics</a></li>
    <li><a class="dropdown-item" href="articles/150_create_risk_report.html">Example usage of create_risk_report.R to create reports of key viticultural areas</a></li>
    <li><a class="dropdown-item" href="articles/160_generate_format_figures.html">Format risk tables for SLF populations and viticultural regions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ieco-lab/slfSpread/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p>Our package <code>slfSpread</code> outlines a workflow for conducting species distribution modeling (SDM) for the risk of establishment of the invasive <em>Lycorma delicatula</em> (spotted lanternfly or SLF) under climate change. We primarily provide tools and resources for viticulturists to assess and respond to the risk SLF for viticulture at their locality. Viticulturists should apply our function <a href="/R/create_risk_report.R">create_risk_report</a> to create risk maps, range shift maps, risk plots and other outputs at the scale of countries or states/provinces. We also apply a novel multi-scale approach to model the global risk for establishment of <em>Lycorma delicatula</em>, which modelers should adapt and apply to other potential invaders under climate change. We find that our multi-scale approach of ensembling MaxEnt models at the regional-scale provides more refined predictions than our global-scale model and highlights important biological limitations on the spread of SLF.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package should be first be downloaded and installed from GitHub by running the following code:</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co"># install.packages("devtools") # if devtools is not installed yet</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ieco-lab/slfSpread"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">slfSpread</span><span class="op">)</span></span></code></pre>
<p>The <strong>dependency</strong> packages should then be installed for the package to run properly:</p>
<p>Here are the main packages that <code>slfSpread</code> depends on:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'cli'</span>, <span class="st">'common'</span>, <span class="st">'CoordinateCleaner'</span>, <span class="st">'devtools'</span>, <span class="st">'dismo'</span>, <span class="st">'dplyr'</span>, <span class="st">'dsmextra'</span>, <span class="st">'ENMTools'</span>, <span class="st">'formattable'</span>, <span class="st">'gginnards'</span>, <span class="st">'ggpattern'</span>, <span class="st">'ggrepel'</span>, <span class="st">'grid'</span>, <span class="st">'here'</span>, <span class="st">'humboldt'</span>, <span class="st">'kableExtra'</span>, <span class="st">'kgc'</span>, <span class="st">'knitr'</span>, <span class="st">'lydemapr'</span>, <span class="st">'patchwork'</span>, <span class="st">'pkgdown'</span>, <span class="st">'plotROC'</span>, <span class="st">'pROC'</span>, <span class="st">'raster'</span>, <span class="st">'rasterVis'</span>, <span class="st">'readr'</span>, <span class="st">'renv'</span>, <span class="st">'rgbif'</span>, <span class="st">'rJava'</span>, <span class="st">'rmarkdown'</span>, <span class="st">'rnaturalearth'</span>, <span class="st">'rnaturalearthhires'</span>, <span class="st">'scales'</span>, <span class="st">'SDMtune'</span>, <span class="st">'sf'</span>, <span class="st">'sp'</span>, <span class="st">'spThin'</span>, <span class="st">'stats'</span>, <span class="st">'stringr'</span>, <span class="st">'taxize'</span>, <span class="st">'terra'</span>, <span class="st">'tibble'</span>, <span class="st">'tidyr'</span>, <span class="st">'tidygeocoder'</span>, <span class="st">'tidyverse'</span>, <span class="st">'usethis'</span>, <span class="st">'utils'</span>, <span class="st">'viridis'</span>, <span class="st">'webshot'</span>, <span class="st">'webshot2'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># install specific version of ggnewscale</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggnewscale"</span>, version <span class="op">=</span> <span class="st">'0.4.10'</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>The package <code>slfSpread</code> is a research compendium for our manuscript, Owens and Helmus, 2024:</p>
<p><strong>insert citation</strong></p>
</div>
<div class="section level1">
<div class="page-header"><h1 id="how-to-use-this-project">How to Use this Project<a class="anchor" aria-label="anchor" href="#how-to-use-this-project"></a>
</h1></div>
<div class="section level2">
<h2 id="id_1-produce-localized-reports-on-slf-risk-to-viticulture">1. Produce localized reports on SLF risk to viticulture<a class="anchor" aria-label="anchor" href="#id_1-produce-localized-reports-on-slf-risk-to-viticulture"></a>
</h2>
<p>Our primary datasets, including risk maps and a viticultural risk analysis, can be accessed by executing the function <code><a href="reference/create_risk_report.html">create_risk_report()</a></code>. This function creates a localized (at the country or state/provincial level) report of the risk for <em>Lycorma delicatula</em> to local viticulture. It can be applied to globally important winegrowing regions because it uses our dataset <code>data/wineries_tidied.rds</code>, which contains a sample (1,074) of the world’s most important winegrowing regions. Users can and should apply this function for their locality as we are projecting that the risk of <em>Lycorma delicatula</em> establishment will exapnd under climate change. <em>Lycorma delicatula</em> has been classified as being capable of (global) pan-invasion and viticulure has already been devastated in some regions, so there is high potential for viticultural damage under climate change (Huron et al, 2022).</p>
<p>Our function rcreates major datasets that we provide in our main analysis, including:</p>
<ol style="list-style-type: decimal">
<li>list of known important wine regions within the locality with predicted suitability values and levels</li>
<li>current and future risk maps for SLF establishment</li>
<li>range shift map of potential range expansion for L delicatula under climate change</li>
<li>viticultural quadrant plot depicting of the risk for SLF establishment for known wine regions within the locality. This plot depicts the intersection of our two modeled scales.</li>
<li>risk table quantifying the level of risk to vineyards according to the quadrant plot</li>
</ol>
<p>Here is an example of a workflow for creating a localized risk map and how this might be applied:</p>
<p>I might begin by creating a report at the national level. To create this, you will need the alpha-3 iso country code.</p>
<pre><code><span><span class="fu">slfSpread</span><span class="fu">::</span><span class="fu"><a href="reference/create_risk_report.html">create_risk_report</a></span><span class="op">(</span></span>
<span>  locality.iso <span class="op">=</span> <span class="st">"usa"</span>,</span>
<span>  locality.type <span class="op">=</span> <span class="st">"country"</span>, <span class="co"># to specifiy the type of report</span></span>
<span>  mypath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"reports"</span>, <span class="st">"United States"</span><span class="op">)</span>,</span>
<span>  create.dir <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># should a directory be created for the report?</span></span>
<span>  save.report <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># should the report be saved?</span></span>
<span><span class="op">)</span></span></code></pre>
<p>You should first note the three most important outputs of this function: 1. the risk maps 2. the accompanying viticultural risk quadrant plot 3. tabled list of viticultural regions in this locality</p>
<p>First, we observe the risk map, which depicts the risk of SLF establishment using the agreement between our regional-scale model ensemble and our global-scale model. More agreement on suitability mean higher risk.</p>
<p><img src="https://github.com/user-attachments/assets/c02e9028-a5df-4993-8c0b-a49a73be679d" width="60%"></p>
<p><strong>Fig. 1:</strong> Projected current and future risk of <em>Lycorma delicatula</em> establishment under climate change | USA</p>
<p>The points on the map represent key viticultural regions. We have extracted the suitability of each viticultural region and depicted its quantitative shift in risk on our second output, the viticultural risk quadrant plot. This plot quantifies the level of risk along both modeled scales, both <span class="math inline">$\color{violet}{\textsf{presently}}$</span> and in the <span class="math inline">$\color{purple}{\textsf{future}}$</span> under a predicted climate change shift (arrows):</p>
<p><img src="https://github.com/user-attachments/assets/49df16d5-d9b2-4c5b-960d-b9dca245f0f9" width="50%"></p>
<p><strong>Fig. 2:</strong> Projected shift in the risk for <em>Lycorma delicatula</em> establishment at key viticultural regions due to climate change | USA</p>
<p>The accompanying table provides a list of key viticultural regions and their geographical region (state/province), with predicted risk levels:</p>
<p><strong>Table 1:</strong> List of viticultural regions and their projected risk</p>
<p><img src="https://github.com/user-attachments/assets/d75eb908-4255-4286-bf9d-f4bcae380937"></p>
<p>You may begin to notice that a particular region has many records, like we can see is the case for Washington State. You could then produce a report only for that region, to get a better idea of the overall trend of risk shift due to climate change. We will produce a report for Washington State alone, to better visualize this trend:</p>
<pre><code><span><span class="fu">slfSpread</span><span class="fu">::</span><span class="fu"><a href="reference/create_risk_report.html">create_risk_report</a></span><span class="op">(</span></span>
<span>  locality.iso <span class="op">=</span> <span class="st">"usa"</span>, <span class="co"># the country iso is still required</span></span>
<span>  locality.name <span class="op">=</span> <span class="st">"washington"</span>, <span class="co"># the name must be specified</span></span>
<span>  locality.type <span class="op">=</span> <span class="st">"state_province"</span>, <span class="co"># we have changed the report type</span></span>
<span>  mypath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"vignette-outputs"</span>, <span class="st">"reports"</span>, <span class="st">"United States"</span><span class="op">)</span>,</span>
<span>  create.dir <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># dir already exists</span></span>
<span>  save.report <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
<p>We can see that most of Washington is at some level of SLF risk presently. Under climate change, risk is projected to decrease some, but one or both modeled scales still predict that SLF can establish in most of the state.</p>
<p><img src="https://github.com/user-attachments/assets/d1019a9c-7649-4bf6-a91b-8338cf54f9d0" width="60%"></p>
<p><strong>Fig. 3:</strong> Projected current and future risk of <em>Lycorma delicatula</em> establishment under climate change | Washington, USA</p>
<p>Based on the viticultural risk quadrant plot, we can now see that Washington state exhibits a totally different trend from the rest of the country. While viticultural regions across the united states exhibit a range of risk levels, regions in Washington are either at high or extreme risk for SLF establishment, and this pattern does not change under predicted climate change levels.</p>
<p><img src="https://github.com/user-attachments/assets/2a94ce74-9df7-45df-989b-fccf79566a93" width="50%"></p>
<p><strong>Fig. 4:</strong> Projected shift in the risk for <em>Lycorma delicatula</em> establishment at key viticultural regions due to climate change | Washington, USA</p>
<p>In our more localized analysis, we might also be interested in quantifying the total area at risk for SLF or the total number of viticultural regions at risk for SLF establishment. For this, we will look at two additional outputs from <code><a href="reference/create_risk_report.html">create_risk_report()</a></code>:</p>
<ol style="list-style-type: decimal">
<li>risk map area table- this quantifies the areas and proportions of the total occupied by each risk category on the risk map</li>
<li>viticultural risk table- this quantifies the number of winegrowing regions that are projected to fall into each risk category, both now and in the future under climate change</li>
</ol>
<p>First, let’s look at the risk map area table:</p>
<p><strong>Table 2:</strong> Table quantifying the projected current and future suitable area for <em>Lycorma delicatula</em> establishment | Washington, USA</p>
<p><img src="https://github.com/user-attachments/assets/e795c878-546d-44d3-9dc2-195850d15029"></p>
<p>We can see from this table that the total unsuitable area decreased under climate change, from 8.6% to 7.4%, but this change was mostly found in the regional-scale model ensemble, which predicted ~9% more suitable arae under climate change. Our modeled scales also diverged in the agreed suitable area (suitable_agreement decreased by ~9%).</p>
<p>Next, lets look at the viticultural risk table:</p>
<p><strong>Table 3:</strong> Table quantifying the projected shift in the risk for <em>Lycorma delicatula</em> establishment at key viticultural regions due to climate change | Washington, USA</p>
<p><img src="https://github.com/user-attachments/assets/76681887-5b69-4256-87dd-2861c4755ba7" width="90%"></p>
<p>From this table, we can see that all 7 viticultural regions maintain their present risk level under climate change. Six regions fall into the high risk category (regional ensemble suitability only) and one falls into the extreme risk category (suitable area agreement).</p>
<p>Users should explore the other localities and data types available with this function.</p>
</div>
<div class="section level2">
<h2 id="id_2-recreate-the-analysis-for-another-invasive-species-of-interest">2. Recreate the analysis for another invasive species of interest<a class="anchor" aria-label="anchor" href="#id_2-recreate-the-analysis-for-another-invasive-species-of-interest"></a>
</h2>
<p>For modelers who wish to apply this pipeline for other invasive species, this pipeline can easily be adapted to model the risk of establishment by simply changing the input datasets and modeled scales.</p>
<p>First, a modeler would need to change the input datasets, outlined in vignettes 020-040. In vignette 020, I retrieved input data from GBIF, which hosts datasets for thousands of other species. I recommend including extra data from other databases and the literature as I did in my analysis, but GBIF is a great starting point for data retrieval. Here is an example using the packages <code>rgbif</code> and <code>taxize</code>:</p>
<p>```{r get taxa ID and GBIF presence data} # get species ID from gbif database ids &lt;- taxize::get_ids(sci_com = “Emerald Ash Borer”, db = “gbif”)</p>
</div>
</div>
<div class="section level1">
<h1 id="initiate-download">initiate download<a class="anchor" aria-label="anchor" href="#initiate-download"></a>
</h1>
<p>records_gbif &lt;- rgbif::occ_download( # general formatting type = “and”, format = “SIMPLE_CSV”, # inclusion rules pred(“taxonKey”, ids[[1]]), # search by ID, not species name pred(“hasCoordinate”, TRUE), pred(“hasGeospatialIssue”, FALSE), pred(“occurrenceStatus”, “PRESENT”) )</p>
<pre><code>
The input covariates would also need to change based on what is biologically relevant for the particular species. I outline the process of choosing input covariates in vignette 030.

Once the input data have been adapted to the user's needs, the regional-scale models will need to be applied per region of interest. Each regional-scale model depends on a spcecific background area selection for MaxEnt that will need to change. I outline the process for choosing this area in vignette 060, in which I subset the presence data by region and intersect these subsets with the Köppen-Geiger climate zones to select the appropriate background area. This resulting polygon would need to be cropped to the region of interest. I use the `kgc`, `terra`, and `sf` packages for this analysis:

```{r get K-G zones and intersect with presence data}
# get K-G zones
kmz_data &lt;- kgc::kmz

# generate coordinates
kmz_lat &lt;- kgc::genCoords(latlon = "lat", full = TRUE)
kmz_lon &lt;- kgc::genCoords(latlon = "lon", full = TRUE)

# join data and coordinates
kmz_data &lt;- cbind(kmz_lat, kmz_lon) %&gt;%
  cbind(., kmz_data) %&gt;%
  as.data.frame() %&gt;%
  # relocate column
  dplyr::select(kmz_lon, everything())

# convert to raster
KG_zones_rast &lt;- terra::rast(
  x = kmz_data,
  type = "xyz",
  crs = "EPSG:4326"
  )

# next, convert raster to polygon
KG_zones_poly &lt;- terra::as.polygons(
  x = KG_zones_rast,
  aggregate = TRUE, # combine cells with the same value into one area
  values = TRUE, # include cell values as attributes
  crs = "EPSG:4326"
)
KG_zones_poly &lt;- sf::st_as_sf(KG_zones_poly)

# intersect polygon and presences
regional_poly &lt;- sf::st_filter(x = KG_zones_poly, y = presence_data)</code></pre>
<p>Once the presence data, coviariate data and background points have been chosen, the user might apply this framework for any invasive species and ensemble models for any region of interest.</p>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<p>Bryant, C., Wheeler, N. R., Rubel, F., &amp; French, R. H. (2017). kgc: Koeppen-Geiger Climatic Zones. <a href="https://CRAN.R-project.org/package=kgc" class="external-link uri">https://CRAN.R-project.org/package=kgc</a></p>
<p>Chamberlain S, Barve V, Mcglinn D, Oldoni D, Desmet P, Geffert L, Ram K (2024). rgbif: Interface to the Global Biodiversity Information Facility API. R package version 3.8.0, <a href="https://CRAN.R-project.org/package=rgbif" class="external-link uri">https://CRAN.R-project.org/package=rgbif</a>.</p>
<p>Scott Chamberlain and Eduard Szocs (2013). taxize - taxonomic search and retrieval in R. F1000Research, 2:191. URL: <a href="https://f1000research.com/articles/2-191/v2" class="external-link uri">https://f1000research.com/articles/2-191/v2</a></p>
<p>Gallien, L., Douzet, R., Pratte, S., Zimmermann, N. E., &amp; Thuiller, W. (2012). Invasive species distribution models – how violating the equilibrium assumption can create new insights. Global Ecology and Biogeography, 21(11), 1126–1136. <a href="https://doi.org/10.1111/j.1466-8238.2012.00768.x" class="external-link uri">https://doi.org/10.1111/j.1466-8238.2012.00768.x</a></p>
<p>Huron, N. A., Behm, J. E., &amp; Helmus, M. R. (2022). Paninvasion severity assessment of a U.S. grape pest to disrupt the global wine market. Communications Biology, 5(1), 655. <a href="https://doi.org/10.1038/s42003-022-03580-w" class="external-link uri">https://doi.org/10.1038/s42003-022-03580-w</a></p>
<p>Pebesma, E., 2018. Simple Features for R: Standardized Support for Spatial Vector Data. The R Journal 10 (1), 439-446, <a href="https://doi.org/10.32614/RJ-2018-009" class="external-link uri">https://doi.org/10.32614/RJ-2018-009</a></p>
<p>Phillips, S. J., Anderson, R. P., &amp; Schapire, R. E. (2006). Maximum entropy modeling of species geographic distributions. Ecological Modelling, 190(3), 231–259. <a href="https://doi.org/10.1016/j.ecolmodel.2005.03.026" class="external-link uri">https://doi.org/10.1016/j.ecolmodel.2005.03.026</a></p>
<p>Hijmans R (2024). terra: Spatial Data Analysis. R package version 1.7-81, <a href="https://rspatial.github.io/terra/" class="external-link uri">https://rspatial.github.io/terra/</a>, <a href="https://rspatial.org/" class="external-link uri">https://rspatial.org/</a>.</p>
<p>Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” Journal of Open Source Software, 4(43), 1686. <a href="doi:10.21105/joss.01686" class="uri">doi:10.21105/joss.01686</a>.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ieco-lab/slfSpread/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing slfSpread</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Samuel M. Owens <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0001-2338-7928" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Matthew R. Helmus <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-3977-0507" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel M. Owens, Matthew R. Helmus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
