% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_risk_report.R
\name{create_risk_report}
\alias{create_risk_report}
\title{Creates a localized report on the risk of establishment of Lycorma delicatula}
\usage{
create_risk_report(
  locality.iso,
  locality.name = locality.iso,
  locality.type,
  save.report = FALSE,
  mypath = NA,
  raster.path = file.path(here::here(), "vignette-outputs", "rasters"),
  create.dir = FALSE,
  map.style = NA,
  buffer.dist = NA
)
}
\arguments{
\item{locality.iso}{The \href{https://www.iso.org/obp/ui/#search}{alpha-3 ISO code}
corresponding to the country of interest. If the desired locality is a state
or province, please still enter the ISO code and supply the name of that
province in \code{locality.name}.}

\item{locality.name}{The name of the country, state or province for which to
generate the report. This is optional if the report is for a country, but
required if the report is for a state/province. Avoid special characters,
but please include those used used in the ethnic naming (ex: CÃ´te d'Ivoire).}

\item{locality.type}{One of "country" or "state_province". If you do
not know the state or province you are looking for, you might create a report
at the country level and then look at the return for the name of the state/province
included.}

\item{save.report}{Logical. Should the report be saved to file? File location
specified by \code{mypath}. Note, this requires the use of Google Chrome.}

\item{mypath}{Character. Only required if saving the report to file.
A file path to the sub directory where the model output will be stored.
Should be used with the \code{\link[=file.path]{file.path()}} function (i.e. with '/' instead of '\\').
If this sub directory does not already exist and should be created by the
function, set \code{create.dir} = TRUE. This will create a folder from the last
part of the filepath in \code{mypath}.}

\item{raster.path}{Character. A file path to the directory containing the rasters
necessary to build this function. See details for the rasters that should be
included with this data input and for the default path.}

\item{create.dir}{Logical. Should the last element of \code{mypath} create a sub
directory for the report? If TRUE, the main folder will be created for
the model output. If FALSE (ie, the sub directory already exists), no directory
will be created.}

\item{map.style}{List. This is used to apply ggplot aesthetics
to the mapped outputs. If specified, the given value should be a list of
ggplot aesthetic options. If not, the built-in default list will be used
(see details). See examples for usage.}

\item{buffer.dist}{Numeric. The distance (in meters) from each IVR coordinate
at which to draw buffers zones on risk maps. Should be the same distance that
was used to calculate the predicted suitability for each IVR region.
See \code{predict.xy.suitability.R} for details. If not specified, buffers are not
drawn and suitabiltiy prediction method is assumed to be simple (point-wise).}
}
\value{
returns a report in list format. If save.report = TRUE, will also save the
report to file at destination specified by \code{mypath}. The outputs returned to
the global env in a list object include:
\itemize{
\item viticultural_regions_list - a list of known important wine regions within the locality with predicted suitability values and levels.
\item risk_maps - a current and future map of risk for L delicatula establishment. The CMIP6 predictions are based on the mean of the three ssp scenarios
\item viticultural_risk_plot = a quantified assessment of the risk for L delicatula establishment for known wine regions within the locality. This plot depicts the intersection of our two modeled scales.
\item viticultural_risk_table = a risk table quantifying the level of risk to vineyards according to the quadrant plot
\item range_shift_map = a map of potential range expansion for L delicatula under climate change
}

Some maps may be formatted strangely because of a country's outlying territories.
You may need to further crop the plot using \code{xlim()} and \code{ylim()} (see examples).

Use caution, this function will overwrite previous files output for the same locality.
}
\description{
This function creates a report at the country or state/province level
for the risk of establishment of Lycorma delicatula. The report covers the major
data outputs from this R package analysis, including current and future risk maps,
range shift maps, risk plots and risk tables.
}
\details{
Requires the following packages: 'tidyverse', 'terra', 'here', 'cli', 'rnaturalearth', 'rnaturalearthhires', 'kableExtra', 'formattable', 'webshot', 'webshot2', 'ggnewscale', 'common'.
\strong{NOTE} This function requires the use of Google Chrome if save.report = TRUE

Note that this function performs downloads from
\href{https://www.naturalearthdata.com/}{naturalearthdata.com}, if the data do not
already exist in \code{root/data-raw}.The function will automatically create
subfolders in \code{root/data-raw} containing the downloaded shapefiles.

This function depends on certain files that have been distributed with this
package, which will be imported from \code{root/R/sysdata.rda} when the function
is run. The code to create \code{sysdata.rda} can be found in
\verb{root/vignettes/160_generate_risk_report.Rmd}.

Here is a list of the files included in \code{sysdata.rda}:
\itemize{
\item global_model_summary.rds                                            | created in vignette 050
\item ensemble_thresh_values.rds                                          | created in vignette 110
\item wineries_tidied.rds                                                 | created in vignette 130
\item regional_ensemble_wineries_1981-2010_xy_pred_suit.rds               | created in vignette 130
\item regional_ensemble_wineries_2041-2070_GFDL_ssp_mean_xy_pred_suit.rds | created in vignette 130
\item global_wineries_1981-2010_xy_pred_suit.rds                          | created in vignette 130
\item global_wineries_2041-2070_GFDL_ssp_mean_xy_pred_suit.rds            | created in vignette 130
}

Additionally, 3 rasters are used to create maps. These rasters are located in
\code{root/vignette-outputs/rasters}, These are the files:
\itemize{
\item slf_binarized_summed_1981-2010.asc                                  | created in vignette 120
\item slf_binarized_summed_2041-2070_ssp_mean_GFDL.asc                    | created in vignette 120
\item slf_range_shift_summed.asc                                          | created in vignette 120
}

Additionally, \code{root/vignette-outputs/rasters} is the default path for the \code{raster.path()} argument.
}
\examples{

# EXAMPLE USAGE:

```R

scarifSDM::create_risk_report(
locality.iso = "aus",
locality.name = "australia",
locality.type = "country",
mypath = file.path(here::here(), "vignette-outputs", "reports", "Australia"),
create.dir = FALSE,
save.report = FALSE,
buffer.dist = 20000 # this is only used for buffered predictions, default is NA for simple predictions.
)

```

# ARGUMENT USAGE:

```R

map_style <- list(
xlab("longitude"),
ylab("latitude"),
theme_classic()
)

```

# The output is in list format, so it should be called using this notation:

```R

# find viticultural regions in locality
viticultural_regions <- slf_risk_report[[2]]

# alternatively, call elements by name:
risk_map_2055 <- slf_risk_report[["risk_maps"]][["2055_risk_map"]]

# sometimes a plot is off-center because the shapefile includes an outlying territory
# you can edit this directly in the ggplot object and save over the report output

map_current <- slf_risk_report[["risk_maps"]][["current_risk_map"]] +
xlim(-10, 5) +
ylim(35, 44)

# If you need to save the report Rdata object and use those figures elsewhere:

readr::write_rds(slf_risk_report, file = file.path(here::here(), "vignette-outputs", "reports", "slf_risk_report.rds"))

```

}
